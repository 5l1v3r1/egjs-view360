/*
Copyright (c) 2017 NAVER Corp.
@egjs/view360 project is licensed under the MIT license
@egjs/view360 JavaScript library
https://github.com/naver/egjs-view360
@version 3.3.0
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@egjs/axes"),require("@egjs/component")):"function"==typeof define&&define.amd?define(["exports","@egjs/axes","@egjs/component"],e):e((t.eg=t.eg||{},t.eg.view360={}),t.eg.Axes,t.eg.Component)}(this,(function(t,e,o){"use strict";function n(){return(n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t}).apply(this,arguments)}function r(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var i="undefined"!=typeof window&&window.Math===Math?window:"undefined"!=typeof self&&self.Math===Math?self:Function("return this")(),a=i.document,l=i.navigator&&i.navigator.userAgent||"",s=navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);-1!==l.indexOf("Safari")&&-1===l.indexOf("Chrome")&&l.indexOf("Mac OS X"),/SamsungBrowser/i.test(l);i.Float32Array=void 0!==i.Float32Array?i.Float32Array:i.Array;i.Float32Array,i.getComputedStyle,i.navigator.userAgent,i.DeviceMotionEvent,i.devicePixelRatio;var u=function(){for(var t=a.documentElement.style,e=["transform","webkitTransform","msTransform","mozTransform"],o=0,n=e.length;o<n;o++)if(e[o]in t)return e[o];return""}(),c=i.CSS&&i.CSS.supports&&i.CSS.supports("will-change","transform"),g=function(){var t=function(t){function e(o,n){var r;r=t.call(this)||this;var i=n||{};return r._el=o,r._rowCount=i.rowCount||1,r._colCount=i.colCount||1,r._totalCount=r._rowCount*r._colCount,r._width=i.width||"auto",r._height=i.height||"auto",r._autoHeight=null!=i.autoHeight?i.autoHeight:"true",r._colRow=[0,0],i.colRow?r._colRow=i.colRow:i.frameIndex&&r.setFrameIndex(i.frameIndex),r._el.style.width=e._getSizeString(r._width),r._el.style.height=e._getSizeString(r._height),i.imageUrl?(r._image=new Image,r._image.onload=function(){r._bg=e._createBgDiv(r._image,r._rowCount,r._colCount,r._autoHeight),r._el.appendChild(r._bg),r.setColRow(r._colRow[0],r._colRow[1]),r.trigger("load",{target:r._el,bgElement:r._bg}),r._autoPlayReservedInfo&&(r.play(r._autoPlayReservedInfo),r._autoPlayReservedInfo=null)},r._image.onerror=function(t){r.trigger("imageError",{imageUrl:i.imageUrl})},r._image.src=i.imageUrl,r):(setTimeout((function(){r.trigger("imageError",{imageUrl:i.imageUrl})}),0),function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(r))}r(e,t),e._createBgDiv=function(t,e,o,n){var r=document.createElement("div");r.style.position="relative",r.style.overflow="hidden",t.style.position="absolute",t.style.width=100*o+"%",t.style.height=100*e+"%",t.ondragstart=function(){return!1},c&&(t.style.willChange="transform"),r.appendChild(t);var i=t.width/o,a=t.height/e;if(n){var l=a/i;r.style.paddingBottom=100*l+"%"}else r.style.height="100%";return r};var o=e.prototype;return o.setFrameIndex=function(t){var e=this.toColRow(t);this.setColRow(e[0],e[1])},o.getFrameIndex=function(){return this._colRow[1]*this._colCount+this._colRow[0]},o.setColRow=function(t,e){e>this._rowCount-1||t>this._colCount-1||(this._image&&u&&(this._image.style[u]="translate("+-t/this._colCount*100+"%, "+-e/this._rowCount*100+"%)"),this._colRow=[t,e])},o.getColRow=function(){return this._colRow},e._getSizeString=function(t){return"number"==typeof t?t+"px":t},o.stop=function(){this._autoPlayTimer&&(clearInterval(this._autoPlayTimer),this._autoPlayTimer=null)},o.play=function(t){var e=this,o=void 0===t?{interval:1e3/this._totalCount,playCount:0}:t,n=o.interval,r=o.playCount;if(this._bg){this._autoPlayTimer&&(clearInterval(this._autoPlayTimer),this._autoPlayTimer=null);var i=this.getFrameIndex(),a=0,l=0;this._autoPlayTimer=setInterval((function(){i%=e._totalCount;var t=e.toColRow(i);e.setColRow(t[0],t[1]),i++,++l===e._totalCount&&(l=0,a++),r>0&&a===r&&clearInterval(e._autoPlayTimer)}),n)}else this._autoPlayReservedInfo={interval:n,playCount:r}},o.toColRow=function(t){var e=this._colCount,o=this._rowCount;return t<0?[0,0]:t>=this._totalCount?[e-1,o-1]:[t%e,Math.floor(t/e)]},e}(o);return t.VERSION="3.3.0",t}(),_=.21,h=function(){var t=function(t){function o(o,r){var i;(i=t.call(this)||this)._el=o;var a=n({},r),l=a.colCount||1,s=a.rowCount||1;return i._scale=a.scale||1,i._panScale=i._scale*_,i._frameCount=l*s,i._sprites=new g(o,a).on({load:function(t){i.trigger("load",t)},imageError:function(t){i.trigger("imageError",{imageUrl:t.imageUrl})}}),i._panInput=new e.PanInput(i._el,{scale:[i._panScale,i._panScale]}),i._axes=new e({angle:{range:[0,359],circular:!0}}).on({change:function(t){var e=Math.floor(t.pos.angle/(360/i._frameCount)),o=i._frameCount-e-1;i._sprites.setFrameIndex(o),i.trigger("change",{frameIndex:o,colRow:i._sprites.getColRow(),angle:t.pos.angle})},animationEnd:function(t){i.trigger("animationEnd",{isTrusted:t.isTrusted})}}),i._axes.connect("angle",i._panInput),i}r(o,t);var i=o.prototype;return i.setScale=function(t){return isNaN(t)||t<0?this:(this._scale=t,this._panScale=t*_,this._panInput.options.scale=[this._panScale,this._panScale],this)},i.getScale=function(){return this._scale},i.spinBy=function(t,e){return void 0===t&&(t=0),void 0===e&&(e={duration:0}),this._axes.setBy({angle:t},e.duration),this},i.spinTo=function(t,e){return void 0===t&&(t=0),void 0===e&&(e={duration:0}),this._axes.setTo({angle:t},e.duration),this},i.getAngle=function(){return this._axes.get().angle||0},o}(o);return t.VERSION="3.3.0",t}();t.SpinViewer=h,t.SpriteImage=g,t.VERSION="3.3.0",Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=view360.spinviewer.min.js.map
