/*!
 * Copyright (c) 2017 NAVER Corp.
 * @egjs/view360 project is licensed under the MIT license
 * 
 * @egjs/view360 JavaScript library
 * 
 * 
 * @version 3.1.0
 */
!function webpackUniversalModuleDefinition(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("@egjs/component"),require("@egjs/axes")):"function"==typeof define&&define.amd?define("view360",["@egjs/component","@egjs/axes"],t):"object"==typeof exports?exports.view360=t(require("@egjs/component"),require("@egjs/axes")):(e.eg=e.eg||{},e.eg.view360=t(e.eg.Component,e.eg.Axes))}(window,function(e,t){return function(e){var t={};function __webpack_require__(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,__webpack_require__),r.l=!0,r.exports}return __webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,n){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.t=function(e,t){if(1&t&&(e=__webpack_require__(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(__webpack_require__.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)__webpack_require__.d(n,r,function(t){return e[t]}.bind(null,r));return n},__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e.default}:function getModuleExports(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=28)}([,function(e,t,n){"use strict";t.__esModule=!0,t.YawPitchControl=void 0;var r=function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}(n(2)),i=n(27);r.default.CONTROL_MODE_VR=i.CONTROL_MODE_VR,r.default.CONTROL_MODE_YAWPITCH=i.CONTROL_MODE_YAWPITCH,r.default.TOUCH_DIRECTION_ALL=i.TOUCH_DIRECTION_ALL,r.default.TOUCH_DIRECTION_YAW=i.TOUCH_DIRECTION_YAW,r.default.TOUCH_DIRECTION_PITCH=i.TOUCH_DIRECTION_PITCH,r.default.TOUCH_DIRECTION_NONE=i.TOUCH_DIRECTION_NONE,t.YawPitchControl=r.default},function(e,t,n){"use strict";t.__esModule=!0;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=_interopRequireDefault(n(3)),o=n(4),a=_interopRequireDefault(o),s=n(5),u=_interopRequireDefault(n(7)),c=_interopRequireDefault(n(24)),l=_interopRequireDefault(n(26)),h=n(14),d=n(27);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var f=[-d.YAW_RANGE_HALF,d.YAW_RANGE_HALF],p=[-d.PITCH_RANGE_HALF,d.PITCH_RANGE_HALF],_=[-d.CIRCULAR_PITCH_RANGE_HALF,d.CIRCULAR_PITCH_RANGE_HALF],g=function(e){function YawPitchControl(t){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,YawPitchControl);var n=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this)),i=r({element:null,yaw:0,pitch:0,fov:65,showPolePoint:!1,useZoom:!0,useKeyboard:!0,gyroMode:d.GYRO_MODE.YAWPITCH,touchDirection:d.TOUCH_DIRECTION_ALL,yawRange:f,pitchRange:p,fovRange:[30,110],aspectRatio:1},t);return n._element=i.element,n._initialFov=i.fov,n._enabled=!1,n._isAnimating=!1,n._deviceQuaternion=null,n._initAxes(i),n.option(i),n}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(YawPitchControl,e),YawPitchControl.prototype._initAxes=function _initAxes(e){var t=this,n=this._updateYawRange(e.yawRange,e.fov,e.aspectRatio),r=this._updatePitchRange(e.pitchRange,e.fov,e.showPolePoint),i=e.gyroMode===d.GYRO_MODE.VR;this.axesPanInput=new c.default(this._element,{useRotation:i}),this.axesWheelInput=new o.WheelInput(this._element,{scale:-4}),this.axesTiltMotionInput=null,this.axesPinchInput=s.SUPPORT_TOUCH?new o.PinchInput(this._element,{scale:-1}):null,this.axesMoveKeyInput=new o.MoveKeyInput(this._element,{scale:[-6,6]}),this.axes=new a.default({yaw:{range:n,circular:YawPitchControl.isCircular(n),bounce:[0,0]},pitch:{range:r,circular:YawPitchControl.isCircular(r),bounce:[0,0]},fov:{range:e.fovRange,circular:[!1,!1],bounce:[0,0]}},{deceleration:d.MC_DECELERATION,maximumDuration:d.MC_MAXIMUM_DURATION},{yaw:e.yaw,pitch:e.pitch,fov:e.fov}).on({hold:function hold(e){t.axes.options.maximumDuration=d.MC_MAXIMUM_DURATION,t.trigger("hold",{isTrusted:e.isTrusted})},change:function change(e){0!==e.delta.fov&&(t._updateControlScale(e),t.updatePanScale()),t._triggerChange(e)},release:function release(e){t._triggerChange(e)},animationStart:function animationStart(e){},animationEnd:function animationEnd(e){t.trigger("animationEnd",{isTrusted:e.isTrusted})}})},YawPitchControl.prototype.updatePanScale=function updatePanScale(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.axes.get().fov,n=e.height||parseInt((0,s.getComputedStyle)(this._element).height,10),r=d.MC_BIND_SCALE[0]*t/this._initialFov*d.PAN_SCALE/n;return this.axesPanInput.options.scale=[r,r],this.axes.options.deceleration=d.MC_DECELERATION*t/d.MAX_FIELD_OF_VIEW,this},YawPitchControl.prototype.option=function option(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t.length;if(0===i)return this._getOptions();if(1===i&&"string"==typeof t[0])return this._getOptions(t[0]);var o=r({},this.options),a={},s=[];return 1===i?(s=Object.keys(t[0]),a=r({},t[0])):i>=2&&(s.push(t[0]),a[t[0]]=t[1]),this._setOptions(this._getValidatedOptions(a)),this._applyOptions(s,o),this},YawPitchControl.prototype._getValidatedOptions=function _getValidatedOptions(e){return e.yawRange&&(e.yawRange=this._getValidYawRange(e.yawRange,e.fov,e.aspectRatio)),e.pitchRange&&(e.pitchRange=this._getValidPitchRange(e.pitchRange,e.fov)),e},YawPitchControl.prototype._getOptions=function _getOptions(e){var t=void 0;return"string"==typeof e?t=this.options[e]:0===arguments.length&&(t=this.options),t},YawPitchControl.prototype._setOptions=function _setOptions(e){for(var t in e)this.options[t]=e[t]},YawPitchControl.prototype._applyOptions=function _applyOptions(e,t){if(e.some(function(e){return"showPolePoint"===e||"fov"===e||"aspectRatio"===e||"yawRange"===e||"pitchRange"===e})&&(this._updateControlScale(),e.indexOf("fov")>=0&&this.updatePanScale()),e.some(function(e){return"fovRange"===e})){var n=this.options.fovRange,r=this.axes.get().fov,i=this.axes.get().fov;h.vec2.copy(this.axes.axis.fov.range,n),i<n[0]?i=n[0]:r>n[1]&&(i=n[1]),r!==i&&(this.axes.setTo({fov:i},0),this._updateControlScale(),this.updatePanScale())}if(e.some(function(e){return"gyroMode"===e})&&s.SUPPORT_DEVICEMOTION){var o=this.options.gyroMode===d.GYRO_MODE.VR,a=this.options.gyroMode===d.GYRO_MODE.YAWPITCH;this.axesTiltMotionInput&&(this.axes.disconnect(this.axesTiltMotionInput),this.axesTiltMotionInput.destroy(),this.axesTiltMotionInput=null),this._deviceQuaternion&&(this._deviceQuaternion.destroy(),this._deviceQuaternion=null),o?this._initDeviceQuaternion():a&&(this.axesTiltMotionInput=new u.default(this._element),this.axes.connect(["yaw","pitch"],this.axesTiltMotionInput)),this.axesPanInput.setUseRotation(o)}e.some(function(e){return"useKeyboard"===e})&&(this.options.useKeyboard?this.axes.connect(["yaw","pitch"],this.axesMoveKeyInput):this.axes.disconnect(this.axesMoveKeyInput));if(e.some(function(e){return"useZoom"===e})){var c=this.options.useZoom;this.axes.disconnect(this.axesWheelInput),c&&this.axes.connect(["fov"],this.axesWheelInput)}this._togglePinchInputByOption(this.options.touchDirection,this.options.useZoom),e.some(function(e){return"touchDirection"===e})&&this._enabled&&this._enableTouch(this.options.touchDirection)},YawPitchControl.prototype._togglePinchInputByOption=function _togglePinchInputByOption(e,t){this.axesPinchInput&&(this.axes.disconnect(this.axesPinchInput),t&&e===d.TOUCH_DIRECTION_ALL&&-1===this.axes._inputs.indexOf(this.axesPinchInput)&&this.axes.connect(["fov"],this.axesPinchInput))},YawPitchControl.prototype._enableTouch=function _enableTouch(e){this.axesPanInput&&this.axes.disconnect(this.axesPanInput);var t=e&d.TOUCH_DIRECTION_YAW?"yaw":null,n=e&d.TOUCH_DIRECTION_PITCH?"pitch":null;this.axes.connect([t,n],this.axesPanInput)},YawPitchControl.prototype._initDeviceQuaternion=function _initDeviceQuaternion(){var e=this;this._deviceQuaternion=new l.default,this._deviceQuaternion.on("change",function(t){e._triggerChange(t)})},YawPitchControl.prototype._getValidYawRange=function _getValidYawRange(e,t,n){var r=YawPitchControl.adjustAspectRatio(n||this.options.aspectRatio||1),i=(t||this.axes.get().fov)*r;return e[1]-e[0]>=i?e:this.options.yawRange||f},YawPitchControl.prototype._getValidPitchRange=function _getValidPitchRange(e,t){var n=t||this.axes.get().fov;return e[1]-e[0]>=n?e:this.options.pitchRange||p},YawPitchControl.isCircular=function isCircular(e){return e[1]-e[0]<360?[!1,!1]:[!0,!0]},YawPitchControl.prototype._updateControlScale=function _updateControlScale(e){var t=this.options,n=this.axes.get().fov,r=this._updatePitchRange(t.pitchRange,n,t.showPolePoint),i=this._updateYawRange(t.yawRange,n,t.aspectRatio),o=this.axes.get(),a=o.yaw,s=o.pitch;return h.vec2.copy(this.axes.axis.yaw.range,i),h.vec2.copy(this.axes.axis.pitch.range,r),this.axes.axis.yaw.circular=YawPitchControl.isCircular(i),this.axes.axis.pitch.circular=YawPitchControl.isCircular(r),a<i[0]?a=i[0]:a>i[1]&&(a=i[1]),s<r[0]?s=r[0]:s>r[1]&&(s=r[1]),e&&e.set({yaw:a,pitch:s}),this.axes.setTo({yaw:a,pitch:s},0),this},YawPitchControl.prototype._updatePitchRange=function _updatePitchRange(e,t,n){if(this.options.gyroMode===d.GYRO_MODE.VR)return _;var r=e[1]-e[0],i=t/2;return n&&!(r<180)?e.map(function(e){return+e.toFixed(5)}):[e[0]+i,e[1]-i].map(function(e){return+e.toFixed(5)})},YawPitchControl.prototype._updateYawRange=function _updateYawRange(e,t,n){if(this.options.gyroMode===d.GYRO_MODE.VR)return f;var r=e[1]-e[0];if(r>=360)return e.map(function(e){return+e.toFixed(5)});var i=1,o=t/2*YawPitchControl.adjustAspectRatio(n);return r>290?i=.794:r>125&&(i=.98),[e[0]*i+o,e[1]*i-o].map(function(e){return+e.toFixed(5)})},YawPitchControl.prototype._triggerChange=function _triggerChange(e){var t=this.axes.get(),n=this.options,r={targetElement:n.element,isTrusted:e.isTrusted};r.yaw=t.yaw,r.pitch=t.pitch,r.fov=t.fov,n.gyroMode===d.GYRO_MODE.VR&&this._deviceQuaternion&&(r.quaternion=this._deviceQuaternion.getCombinedQuaternion(t.yaw,t.pitch)),this.trigger("change",r)},YawPitchControl.adjustAspectRatio=function adjustAspectRatio(e){for(var t=[.52,.54,.563,.57,.584,.59,.609,.67,.702,.72,.76,.78,.82,.92,.97,1,1.07,1.14,1.19,1.25,1.32,1.38,1.4,1.43,1.53,1.62,1.76,1.77,1.86,1.96,2.26,2.3,2.6,3,5,6],n=[.51,.54,.606,.56,.628,.63,.647,.71,.736,.757,.78,.77,.8,.89,.975,1,1.07,1.1,1.15,1.18,1.22,1.27,1.3,1.33,1.39,1.45,1.54,1.55,1.58,1.62,1.72,1.82,1.92,2,2.24,2.3],r=-1,i=0;i<t.length-1;i++)if(t[i]<=e&&t[i+1]>=e){r=i;break}if(-1===r)return t[0]>e?n[0]:n[n[0].length-1];var o=t[r],a=t[r+1],s=n[r],u=n[r+1];return YawPitchControl.lerp(s,u,(e-o)/(a-o))},YawPitchControl.lerp=function lerp(e,t,n){return e+n*(t-e)},YawPitchControl.prototype.enable=function enable(){return this._enabled?this:(this._enabled=!0,this._applyOptions(Object.keys(this.options),this.options),this.updatePanScale(),this)},YawPitchControl.prototype.disable=function disable(e){return this._enabled?(e||this._resetOrientation(),this.axes.disconnect(),this._enabled=!1,this):this},YawPitchControl.prototype._resetOrientation=function _resetOrientation(){var e=this.options;return this.axes.setTo({yaw:e.yaw,pitch:e.pitch,fov:e.fov},0),this},YawPitchControl.prototype.lookAt=function lookAt(e,t){var n=e.yaw,r=e.pitch,i=e.fov,o=this.axes.get(),a=void 0===n?0:n-o.yaw,s=void 0===r?0:r-o.pitch,u=void 0===i?0:i-o.fov;this.axes.options.maximumDuration=1/0,this.axes.setBy({yaw:a,pitch:s,fov:u},t)},YawPitchControl.prototype.get=function get(){return this.axes.get()},YawPitchControl.prototype.getYaw=function getYaw(){return this.axes.get().yaw},YawPitchControl.prototype.getPitch=function getPitch(){return this.axes.get().pitch},YawPitchControl.prototype.getFov=function getFov(){return this.axes.get().fov},YawPitchControl.prototype.destroy=function destroy(){this.axes&&this.axes.destroy(),this.axisPanInput&&this.axisPanInput.destroy(),this.axesWheelInput&&this.axesWheelInput.destroy(),this.axesTiltMotionInput&&this.axesTiltMotionInput.destroy(),this.axesDeviceOrientationInput&&this.axesDeviceOrientationInput.destroy(),this.axesPinchInput&&this.axesPinchInput.destroy(),this.axesMoveKeyInput&&this.axesMoveKeyInput.destroy(),this._deviceQuaternion&&this._deviceQuaternion.destroy()},YawPitchControl}(i.default);g.VERSION="3.1.0",t.default=g},function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t,n){"use strict";t.__esModule=!0,t.devicePixelRatio=t.DeviceMotionEvent=t.SUPPORT_WILLCHANGE=t.SUPPORT_DEVICEMOTION=t.SUPPORT_TOUCH=t.TRANSFORM=t.userAgent=t.getComputedStyle=t.Float32Array=void 0;var r=n(6);r.window.Float32Array=void 0!==r.window.Float32Array?r.window.Float32Array:r.window.Array;var i=r.window.Float32Array,o=r.window.getComputedStyle,a=r.window.navigator.userAgent,s="ontouchstart"in r.window,u="ondevicemotion"in r.window,c=r.window.DeviceMotionEvent,l=r.window.devicePixelRatio,h=function(){for(var e=r.document.documentElement.style,t=["transform","webkitTransform","msTransform","mozTransform"],n=0,i=t.length;n<i;n++)if(t[n]in e)return t[n];return""}(),d=r.window.CSS&&r.window.CSS.supports&&r.window.CSS.supports("will-change","transform");t.Float32Array=i,t.getComputedStyle=o,t.userAgent=a,t.TRANSFORM=h,t.SUPPORT_TOUCH=s,t.SUPPORT_DEVICEMOTION=u,t.SUPPORT_WILLCHANGE=d,t.DeviceMotionEvent=c,t.devicePixelRatio=l},function(e,t,n){"use strict";t.__esModule=!0;var r="undefined"!=typeof window&&window.Math===Math?window:"undefined"!=typeof self&&self.Math===Math?self:Function("return this")(),i=r.document;t.window=r,t.document=i},function(e,t,n){"use strict";t.__esModule=!0;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=_interopRequireDefault(n(3)),o=n(8),a=_interopRequireDefault(n(9)),s=n(14);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function TiltMotionInput(t,n){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TiltMotionInput);var i=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this));return i.element=t,i._prevQuaternion=null,i._quaternion=null,i.fusionPoseSensor=null,i.options=r({scale:1,threshold:0},n),i._onPoseChange=i._onPoseChange.bind(i),i}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(TiltMotionInput,e),TiltMotionInput.prototype.mapAxes=function mapAxes(e){this.axes=e},TiltMotionInput.prototype.connect=function connect(e){return this.observer?this:(this.observer=e,this.fusionPoseSensor=new a.default,this.fusionPoseSensor.enable(),this._attachEvent(),this)},TiltMotionInput.prototype.disconnect=function disconnect(){return this.observer?(this._dettachEvent(),this.fusionPoseSensor.disable(),this.fusionPoseSensor.destroy(),this.fusionPoseSensor=null,this.observer=null,this):this},TiltMotionInput.prototype.destroy=function destroy(){this.disconnect(),this.element=null,this.options=null,this.axes=null,this._prevQuaternion=null,this._quaternion=null},TiltMotionInput.prototype._onPoseChange=function _onPoseChange(e){if(!this._prevQuaternion)return this._prevQuaternion=s.quat.clone(e.quaternion),void(this._quaternion=s.quat.clone(e.quaternion));s.quat.copy(this._prevQuaternion,this._quaternion),s.quat.copy(this._quaternion,e.quaternion),this.observer.change(this,e,(0,o.toAxis)(this.axes,[function getDeltaYaw(e,t){var n=s.util.getRotationDelta(e,t,s.ROTATE_CONSTANT.YAW_DELTA_BY_YAW);return s.util.getRotationDelta(e,t,s.ROTATE_CONSTANT.YAW_DELTA_BY_ROLL)*Math.sin(s.util.extractPitchFromQuat(t))+n}(this._prevQuaternion,this._quaternion),function getDeltaPitch(e,t){return s.util.getRotationDelta(e,t,s.ROTATE_CONSTANT.PITCH_DELTA)}(this._prevQuaternion,this._quaternion)]))},TiltMotionInput.prototype._attachEvent=function _attachEvent(){this.fusionPoseSensor.on("change",this._onPoseChange)},TiltMotionInput.prototype._dettachEvent=function _dettachEvent(){this.fusionPoseSensor.off("change",this._onPoseChange)},TiltMotionInput}(i.default);t.default=u},function(e,t,n){"use strict";t.__esModule=!0;var r={};function toAxis(e,t){return t.reduce(function(t,n,r){return e[r]&&(t[e[r]]=n),t},{})}r.toAxis=toAxis,t.default=r,t.toAxis=toAxis},function(e,t,n){"use strict";t.__esModule=!0;var r=_interopRequireDefault(n(3)),i=_interopRequireDefault(n(10)),o=_interopRequireDefault(n(11)),a=_interopRequireDefault(n(12)),s=_interopRequireDefault(n(13)),u=n(6),c=n(14),l=_interopRequireDefault(n(20)),h=_interopRequireDefault(n(21));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var d=.98,f=.04,p=(0,i.default)(),_=function(e){function FusionPoseSensor(){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FusionPoseSensor);var t=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this));return t.deviceMotion=new l.default,t.accelerometer=new a.default.Vector3,t.gyroscope=new a.default.Vector3,t._onDeviceMotionChange=t._onDeviceMotionChange.bind(t),t._onScreenOrientationChange=t._onScreenOrientationChange.bind(t),t.filter=new h.default(d),t.posePredictor=new o.default(f),t.filterToWorldQ=new a.default.Quaternion,t.isFirefoxAndroid=s.default.isFirefoxAndroid(),t.isIOS=s.default.isIOS(),t.isChromeUsingDegrees="chrome"===p.browser.name&&parseInt(p.browser.version,10)>=66,t._isEnabled=!1,t.isIOS?t.filterToWorldQ.setFromAxisAngle(new a.default.Vector3(1,0,0),Math.PI/2):t.filterToWorldQ.setFromAxisAngle(new a.default.Vector3(1,0,0),-Math.PI/2),t.inverseWorldToScreenQ=new a.default.Quaternion,t.worldToScreenQ=new a.default.Quaternion,t.originalPoseAdjustQ=new a.default.Quaternion,t.originalPoseAdjustQ.setFromAxisAngle(new a.default.Vector3(0,0,1),-u.window.orientation*Math.PI/180),t._setScreenTransform(),s.default.isLandscapeMode()&&t.filterToWorldQ.multiply(t.inverseWorldToScreenQ),t.resetQ=new a.default.Quaternion,t.deviceMotion.on("devicemotion",t._onDeviceMotionChange),t.enable(),t}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(FusionPoseSensor,e),FusionPoseSensor.prototype.enable=function enable(){this.isEnabled()||(this.deviceMotion.enable(),this._isEnabled=!0,u.window.addEventListener("orientationchange",this._onScreenOrientationChange))},FusionPoseSensor.prototype.disable=function disable(){this.isEnabled()&&(this.deviceMotion.disable(),this._isEnabled=!1,u.window.removeEventListener("orientationchange",this._onScreenOrientationChange))},FusionPoseSensor.prototype.isEnabled=function isEnabled(){return this._isEnabled},FusionPoseSensor.prototype.destroy=function destroy(){this.disable(),this.deviceMotion=null},FusionPoseSensor.prototype._triggerChange=function _triggerChange(){var e=this.getOrientation();e&&(this._prevOrientation?c.quat.equals(this._prevOrientation,e)||this.trigger("change",{quaternion:e}):this._prevOrientation=e)},FusionPoseSensor.prototype.getOrientation=function getOrientation(){var e=void 0;if(this.deviceMotion.isWithoutDeviceMotion&&this._deviceOrientationQ){this.deviceOrientationFixQ=this.deviceOrientationFixQ||function(){return(new a.default.Quaternion).setFromAxisAngle(new a.default.Vector3(0,1,0),-this._alpha)}.bind(this)(),e=this._deviceOrientationQ;var t=new a.default.Quaternion;t.copy(e),t.multiply(this.filterToWorldQ),t.multiply(this.resetQ),t.multiply(this.worldToScreenQ),t.multiplyQuaternions(this.deviceOrientationFixQ,t);var n=c.quat.fromValues(t.x,t.y,t.z,t.w);return c.quat.normalize(n,n)}if(!(e=this.filter.getOrientation()))return null;var r=this._convertFusionToPredicted(e),i=c.quat.fromValues(r.x,r.y,r.z,r.w);return c.quat.normalize(i,i)},FusionPoseSensor.prototype._convertFusionToPredicted=function _convertFusionToPredicted(e){this.predictedQ=this.posePredictor.getPrediction(e,this.gyroscope,this.previousTimestampS);var t=new a.default.Quaternion;return t.copy(this.filterToWorldQ),t.multiply(this.resetQ),t.multiply(this.predictedQ),t.multiply(this.worldToScreenQ),t},FusionPoseSensor.prototype._onDeviceMotionChange=function _onDeviceMotionChange(e){var t=e.inputEvent,n=t.deviceorientation,r=t,i=r.accelerationIncludingGravity,o=r.adjustedRotationRate||r.rotationRate,s=r.timeStamp/1e3;n?(this._alpha||(this._alpha=n.alpha),this._deviceOrientationQ=this._deviceOrientationQ||new a.default.Quaternion,this._deviceOrientationQ.setFromEulerYXZ(n.beta,n.alpha,n.gamma),this._triggerChange()):(this.isFirefoxAndroid&&(s/=1e3),this.accelerometer.set(-i.x,-i.y,-i.z),this.gyroscope.set(o.alpha,o.beta,o.gamma),(this.isIOS||this.isFirefoxAndroid||this.isChromeUsingDegrees)&&this.gyroscope.multiplyScalar(Math.PI/180),this.filter.addAccelMeasurement(this.accelerometer,s),this.filter.addGyroMeasurement(this.gyroscope,s),this._triggerChange(),this.previousTimestampS=s)},FusionPoseSensor.prototype._onScreenOrientationChange=function _onScreenOrientationChange(e){this._setScreenTransform(u.window.orientation)},FusionPoseSensor.prototype._setScreenTransform=function _setScreenTransform(){switch(this.worldToScreenQ.set(0,0,0,1),u.window.orientation){case 0:break;case 90:this.worldToScreenQ.setFromAxisAngle(new a.default.Vector3(0,0,1),-.5*Math.PI);break;case-90:this.worldToScreenQ.setFromAxisAngle(new a.default.Vector3(0,0,1),.5*Math.PI);break;case 180:this.worldToScreenQ.setFromAxisAngle(new a.default.Vector3(0,0,1),-1*Math.PI)}this.inverseWorldToScreenQ.copy(this.worldToScreenQ),this.inverseWorldToScreenQ.inverse()},FusionPoseSensor}(r.default);t.default=_},function(e,t,n){!function webpackUniversalModuleDefinition(t,n){e.exports=n()}(0,function(){return function(e){var t={};function __webpack_require__(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,__webpack_require__),r.l=!0,r.exports}return __webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,n){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e.default}:function getModuleExports(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=0)}([function(e,t,n){"use strict";var r=function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}(n(1));e.exports=r.default},function(e,t,n){"use strict";t.__esModule=!0;var r=n(2),i=function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}(n(3));function agent(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.navigator.userAgent;i.default.setUa(e);var t={os:i.default.getOs(),browser:i.default.getBrowser(),isMobile:i.default.getIsMobile()};return t.browser.name=t.browser.name.toLowerCase(),t.os.name=t.os.name.toLowerCase(),t.os.version=t.os.version.toLowerCase(),"ios"===t.os.name&&t.browser.webview&&(t.browser.version="-1"),t}agent.VERSION="2.1.2",t.default=agent,e.exports=t.default},function(e,t,n){"use strict";t.__esModule=!0;var r="undefined"!=typeof window&&window||{};t.RegExp=r.RegExp,t.navigator=r.navigator},function(e,t,n){"use strict";t.__esModule=!0;var r=function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}(n(4));var i=void 0;function isMatched(e,t){return t&&t.test?!!t.test(e):e.indexOf(t)>-1}function getIdentityStringFromArray(e,t){var n=e.filter(function(e){return isMatched(i,e.criteria)})[0];return n&&n.identity||t.name}function getRule(e,t){return e.filter(function(e){var n=e.criteria,r=new RegExp(e.identity,"i").test(t);return!!(n?r&&isMatched(i,n):r)})[0]}function extractBrowserVersion(e,t){var n=r.default.defaultString.browser.version,i=new RegExp("("+e+")","i").exec(t);if(!i)return n;var o=i.index,a=i[0];if(o>-1){var s=o+a.length+1;n=t.substring(s).split(" ")[0].replace(/_/g,".").replace(/;|\)/g,"")}return n}function getBrowserVersion(e){if(e)return extractBrowserVersion(function getBrowserRule(e){var t=getRule(r.default.browser,e);return t||(t={criteria:e,versionSearch:e,identity:e}),t}(e).versionSearch||e,i)}function getOsVersion(e){var t=function getOSRule(e){return getRule(r.default.os,e)}(e)||{},n=r.default.defaultString.os.version,o=void 0;if(e){if(t.versionAlias)return t.versionAlias;var a=t.versionSearch||e,s=new RegExp("("+a+")\\s([\\d_\\.]+|\\d_0)","i");return s.exec(i)&&(o=s.exec(i)[2].replace(/_/g,".").replace(/;|\)/g,"")),o||n}}t.default={getOs:function getOs(){var e=function getOsName(){return getIdentityStringFromArray(r.default.os,r.default.defaultString.os)}();return{name:e,version:getOsVersion(e)}},getBrowser:function getBrowser(){var e=function getBrowserName(){return getIdentityStringFromArray(r.default.browser,r.default.defaultString.browser)}();return{name:e,version:getBrowserVersion(e),webview:function isWebview(){var e=void 0;return r.default.webview.filter(function(e){return isMatched(i,e.criteria)}).some(function(t){return e=extractBrowserVersion(t.browserVersionSearch,i),!(!isMatched(i,t.webviewToken)&&!isMatched(e,t.webviewBrowserVersion))})}()}},getIsMobile:function getIsMobile(){return-1!==i.indexOf("Mobi")},setUa:function setUa(e){i=e}},e.exports=t.default},function(e,t,n){"use strict";t.__esModule=!0;t.default={browser:[{criteria:"PhantomJS",identity:"PhantomJS"},{criteria:/Whale/,identity:"Whale",versionSearch:"Whale"},{criteria:/Edge/,identity:"Edge",versionSearch:"Edge"},{criteria:/MSIE|Trident|Windows Phone/,identity:"IE",versionSearch:"IEMobile|MSIE|rv"},{criteria:/MiuiBrowser/,identity:"MIUI Browser",versionSearch:"MiuiBrowser"},{criteria:/SamsungBrowser/,identity:"Samsung Internet",versionSearch:"SamsungBrowser"},{criteria:/SAMSUNG /,identity:"Samsung Internet",versionSearch:"Version"},{criteria:/Chrome|CriOS/,identity:"Chrome"},{criteria:/Android/,identity:"Android Browser",versionSearch:"Version"},{criteria:/iPhone|iPad/,identity:"Safari",versionSearch:"Version"},{criteria:"Apple",identity:"Safari",versionSearch:"Version"},{criteria:"Firefox",identity:"Firefox"}],os:[{criteria:/Windows Phone/,identity:"Windows Phone",versionSearch:"Windows Phone"},{criteria:"Windows 2000",identity:"Window",versionAlias:"5.0"},{criteria:/Windows NT/,identity:"Window",versionSearch:"Windows NT"},{criteria:/iPhone|iPad/,identity:"iOS",versionSearch:"iPhone OS|CPU OS"},{criteria:"Mac",versionSearch:"OS X",identity:"MAC"},{criteria:/Android/,identity:"Android"},{criteria:/Tizen/,identity:"Tizen"},{criteria:/Web0S/,identity:"WebOS"}],webview:[{criteria:/iPhone|iPad/,browserVersionSearch:"Version",webviewBrowserVersion:/-1/},{criteria:/iPhone|iPad|Android/,webviewToken:/NAVER|DAUM|; wv/}],defaultString:{browser:{version:"-1",name:"unknown"},os:{version:"-1",name:"unknown"}}},e.exports=t.default}])})},function(e,t,n){var r=n(12),i=n(13);function PosePredictor(e){this.predictionTimeS=e,this.previousQ=new r.Quaternion,this.previousTimestampS=null,this.deltaQ=new r.Quaternion,this.outQ=new r.Quaternion}PosePredictor.prototype.getPrediction=function(e,t,n){if(!this.previousTimestampS)return this.previousQ.copy(e),this.previousTimestampS=n,e;var o=new r.Vector3;o.copy(t),o.normalize();var a=t.length();if(a<20*r.degToRad)return i.isDebug()&&console.log("Moving slowly, at %s deg/s: no prediction",(r.radToDeg*a).toFixed(1)),this.outQ.copy(e),this.previousQ.copy(e),this.outQ;this.previousTimestampS;var s=a*this.predictionTimeS;return this.deltaQ.setFromAxisAngle(o,s),this.outQ.copy(this.previousQ),this.outQ.multiply(this.deltaQ),this.previousQ.copy(e),this.previousTimestampS=n,this.outQ},e.exports=PosePredictor},function(e,t){var n,r,i=window.MathUtil||{};i.degToRad=Math.PI/180,i.radToDeg=180/Math.PI,i.Vector2=function(e,t){this.x=e||0,this.y=t||0},i.Vector2.prototype={constructor:i.Vector2,set:function(e,t){return this.x=e,this.y=t,this},copy:function(e){return this.x=e.x,this.y=e.y,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}},i.Vector3=function(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0},i.Vector3.prototype={constructor:i.Vector3,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var e=this.length();if(0!==e){var t=1/e;this.multiplyScalar(t)}else this.x=0,this.y=0,this.z=0;return this},multiplyScalar:function(e){this.x*=e,this.y*=e,this.z*=e},applyQuaternion:function(e){var t=this.x,n=this.y,r=this.z,i=e.x,o=e.y,a=e.z,s=e.w,u=s*t+o*r-a*n,c=s*n+a*t-i*r,l=s*r+i*n-o*t,h=-i*t-o*n-a*r;return this.x=u*s+h*-i+c*-a-l*-o,this.y=c*s+h*-o+l*-i-u*-a,this.z=l*s+h*-a+u*-o-c*-i,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},crossVectors:function(e,t){var n=e.x,r=e.y,i=e.z,o=t.x,a=t.y,s=t.z;return this.x=r*s-i*a,this.y=i*o-n*s,this.z=n*a-r*o,this}},i.Quaternion=function(e,t,n,r){this.x=e||0,this.y=t||0,this.z=n||0,this.w=void 0!==r?r:1},i.Quaternion.prototype={constructor:i.Quaternion,set:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},setFromEulerXYZ:function(e,t,n){var r=Math.cos(e/2),i=Math.cos(t/2),o=Math.cos(n/2),a=Math.sin(e/2),s=Math.sin(t/2),u=Math.sin(n/2);return this.x=a*i*o+r*s*u,this.y=r*s*o-a*i*u,this.z=r*i*u+a*s*o,this.w=r*i*o-a*s*u,this},setFromEulerYXZ:function(e,t,n){var r=Math.cos(e/2),i=Math.cos(t/2),o=Math.cos(n/2),a=Math.sin(e/2),s=Math.sin(t/2),u=Math.sin(n/2);return this.x=a*i*o+r*s*u,this.y=r*s*o-a*i*u,this.z=r*i*u-a*s*o,this.w=r*i*o+a*s*u,this},setFromAxisAngle:function(e,t){var n=t/2,r=Math.sin(n);return this.x=e.x*r,this.y=e.y*r,this.z=e.z*r,this.w=Math.cos(n),this},multiply:function(e){return this.multiplyQuaternions(this,e)},multiplyQuaternions:function(e,t){var n=e.x,r=e.y,i=e.z,o=e.w,a=t.x,s=t.y,u=t.z,c=t.w;return this.x=n*c+o*a+r*u-i*s,this.y=r*c+o*s+i*a-n*u,this.z=i*c+o*u+n*s-r*a,this.w=o*c-n*a-r*s-i*u,this},inverse:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.normalize(),this},normalize:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=1):(e=1/e,this.x=this.x*e,this.y=this.y*e,this.z=this.z*e,this.w=this.w*e),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this.x,r=this.y,i=this.z,o=this.w,a=o*e.w+n*e.x+r*e.y+i*e.z;if(a<0?(this.w=-e.w,this.x=-e.x,this.y=-e.y,this.z=-e.z,a=-a):this.copy(e),a>=1)return this.w=o,this.x=n,this.y=r,this.z=i,this;var s=Math.acos(a),u=Math.sqrt(1-a*a);if(Math.abs(u)<.001)return this.w=.5*(o+this.w),this.x=.5*(n+this.x),this.y=.5*(r+this.y),this.z=.5*(i+this.z),this;var c=Math.sin((1-t)*s)/u,l=Math.sin(t*s)/u;return this.w=o*c+this.w*l,this.x=n*c+this.x*l,this.y=r*c+this.y*l,this.z=i*c+this.z*l,this},setFromUnitVectors:function(e,t){return void 0===n&&(n=new i.Vector3),(r=e.dot(t)+1)<1e-6?(r=0,Math.abs(e.x)>Math.abs(e.z)?n.set(-e.y,e.x,0):n.set(0,-e.z,e.y)):n.crossVectors(e,t),this.x=n.x,this.y=n.y,this.z=n.z,this.w=r,this.normalize(),this}},e.exports=i},function(e,t){var n,r,i,o,a,s=window.Util||{};s.MIN_TIMESTEP=.001,s.MAX_TIMESTEP=1,s.base64=function(e,t){return"data:"+e+";base64,"+t},s.clamp=function(e,t,n){return Math.min(Math.max(t,e),n)},s.lerp=function(e,t,n){return e+(t-e)*n},s.race=function(e){return Promise.race?Promise.race(e):new Promise(function(t,n){for(var r=0;r<e.length;r++)e[r].then(t,n)})},s.isIOS=(n=/iPad|iPhone|iPod/.test(navigator.platform),function(){return n}),s.isWebViewAndroid=(r=-1!==navigator.userAgent.indexOf("Version")&&-1!==navigator.userAgent.indexOf("Android")&&-1!==navigator.userAgent.indexOf("Chrome"),function(){return r}),s.isSafari=(i=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),function(){return i}),s.isFirefoxAndroid=(o=-1!==navigator.userAgent.indexOf("Firefox")&&-1!==navigator.userAgent.indexOf("Android"),function(){return o}),s.isR7=(a=-1!==navigator.userAgent.indexOf("R7 Build"),function(){return a}),s.isLandscapeMode=function(){var e=90==window.orientation||-90==window.orientation;return s.isR7()?!e:e},s.isTimestampDeltaValid=function(e){return!isNaN(e)&&(!(e<=s.MIN_TIMESTEP)&&!(e>s.MAX_TIMESTEP))},s.getScreenWidth=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},s.getScreenHeight=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},s.requestFullscreen=function(e){if(s.isWebViewAndroid())return!1;if(e.requestFullscreen)e.requestFullscreen();else if(e.webkitRequestFullscreen)e.webkitRequestFullscreen();else if(e.mozRequestFullScreen)e.mozRequestFullScreen();else{if(!e.msRequestFullscreen)return!1;e.msRequestFullscreen()}return!0},s.exitFullscreen=function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else{if(!document.msExitFullscreen)return!1;document.msExitFullscreen()}return!0},s.getFullscreenElement=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},s.linkProgram=function(e,t,n,r){var i=e.createShader(e.VERTEX_SHADER);e.shaderSource(i,t),e.compileShader(i);var o=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(o,n),e.compileShader(o);var a=e.createProgram();for(var s in e.attachShader(a,i),e.attachShader(a,o),r)e.bindAttribLocation(a,r[s],s);return e.linkProgram(a),e.deleteShader(i),e.deleteShader(o),a},s.getProgramUniforms=function(e,t){for(var n={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),i="",o=0;o<r;o++){n[i=e.getActiveUniform(t,o).name.replace("[0]","")]=e.getUniformLocation(t,i)}return n},s.orthoMatrix=function(e,t,n,r,i,o,a){var s=1/(t-n),u=1/(r-i),c=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*u,e[14]=(a+o)*c,e[15]=1,e},s.copyArray=function(e,t){for(var n=0,r=e.length;n<r;n++)t[n]=e[n]},s.isMobile=function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t},s.extend=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},s.safariCssSizeWorkaround=function(e){if(s.isIOS()){var t=e.style.width,n=e.style.height;e.style.width=parseInt(t)+1+"px",e.style.height=parseInt(n)+"px",setTimeout(function(){e.style.width=t,e.style.height=n},100)}window.Util=s,window.canvas=e},s.isDebug=function(){return s.getQueryParameter("debug")},s.getQueryParameter=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))},s.frameDataFromPose=function(){var e=Math.PI/180,t=.25*Math.PI;var n=new Float32Array([0,0,0,1]),r=new Float32Array([0,0,0]);function updateEyeMatrices(i,o,a,s,u){!function mat4_perspectiveFromFieldOfView(n,r,i,o){var a=Math.tan(r?r.upDegrees*e:t),s=Math.tan(r?r.downDegrees*e:t),u=Math.tan(r?r.leftDegrees*e:t),c=Math.tan(r?r.rightDegrees*e:t),l=2/(u+c),h=2/(a+s);return n[0]=l,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=h,n[6]=0,n[7]=0,n[8]=-(u-c)*l*.5,n[9]=(a-s)*h*.5,n[10]=o/(i-o),n[11]=-1,n[12]=0,n[13]=0,n[14]=o*i/(i-o),n[15]=0,n}(i,s?s.fieldOfView:null,u.depthNear,u.depthFar),function mat4_fromRotationTranslation(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=r+r,u=i+i,c=o+o,l=r*s,h=r*u,d=r*c,f=i*u,p=i*c,_=o*c,g=a*s,v=a*u,m=a*c;return e[0]=1-(f+_),e[1]=h+m,e[2]=d-v,e[3]=0,e[4]=h-m,e[5]=1-(l+_),e[6]=p+g,e[7]=0,e[8]=d+v,e[9]=p-g,e[10]=1-(l+f),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}(o,a.orientation||n,a.position||r),s&&function mat4_translate(e,t,n){var r,i,o,a,s,u,c,l,h,d,f,p,_=n[0],g=n[1],v=n[2];return t===e?(e[12]=t[0]*_+t[4]*g+t[8]*v+t[12],e[13]=t[1]*_+t[5]*g+t[9]*v+t[13],e[14]=t[2]*_+t[6]*g+t[10]*v+t[14],e[15]=t[3]*_+t[7]*g+t[11]*v+t[15]):(r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],h=t[8],d=t[9],f=t[10],p=t[11],e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=u,e[6]=c,e[7]=l,e[8]=h,e[9]=d,e[10]=f,e[11]=p,e[12]=r*_+s*g+h*v+t[12],e[13]=i*_+u*g+d*v+t[13],e[14]=o*_+c*g+f*v+t[14],e[15]=a*_+l*g+p*v+t[15]),e}(o,o,s.offset),function mat4_invert(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],h=t[9],d=t[10],f=t[11],p=t[12],_=t[13],g=t[14],v=t[15],m=n*s-r*a,y=n*u-i*a,w=n*c-o*a,R=r*u-i*s,E=r*c-o*s,T=i*c-o*u,b=l*_-h*p,x=l*g-d*p,C=l*v-f*p,P=h*g-d*_,O=h*v-f*_,I=d*v-f*g,A=m*I-y*O+w*P+R*C-E*x+T*b;return A?(A=1/A,e[0]=(s*I-u*O+c*P)*A,e[1]=(i*O-r*I-o*P)*A,e[2]=(_*T-g*E+v*R)*A,e[3]=(d*E-h*T-f*R)*A,e[4]=(u*C-a*I-c*x)*A,e[5]=(n*I-i*C+o*x)*A,e[6]=(g*w-p*T-v*y)*A,e[7]=(l*T-d*w+f*y)*A,e[8]=(a*O-s*C+c*b)*A,e[9]=(r*C-n*O-o*b)*A,e[10]=(p*E-_*w+v*m)*A,e[11]=(h*w-l*E-f*m)*A,e[12]=(s*x-a*P-u*b)*A,e[13]=(n*P-r*x+i*b)*A,e[14]=(_*y-p*R-g*m)*A,e[15]=(l*R-h*y+d*m)*A,e):null}(o,o)}return function(e,t,n){return!(!e||!t)&&(e.pose=t,e.timestamp=t.timestamp,updateEyeMatrices(e.leftProjectionMatrix,e.leftViewMatrix,t,n.getEyeParameters("left"),n),updateEyeMatrices(e.rightProjectionMatrix,e.rightViewMatrix,t,n.getEyeParameters("right"),n),!0)}}(),s.isInsideCrossDomainIFrame=function(){var e=window.self!==window.top,t=s.getDomainFromUrl(document.referrer),n=s.getDomainFromUrl(window.location.href);return e&&t!==n},s.getDomainFromUrl=function(e){return(e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0]).split(":")[0]},e.exports=s},function(e,t,n){"use strict";t.__esModule=!0,t.ROTATE_CONSTANT=t.vec3=t.vec2=t.quat=t.mat4=t.glMatrix=t.util=void 0;var r=_interopRequireDefault(n(15)),i=_interopRequireDefault(n(16)),o=_interopRequireDefault(n(17)),a=_interopRequireDefault(n(18)),s=_interopRequireDefault(n(19));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var u={isPowerOfTwo:function(e){return e&&0==(e&e-1)}};u.extractPitchFromQuat=function(e){var t=function quatToVec3(e){var t=i.default.fromValues(0,0,1);return i.default.transformQuat(t,t,e),t}(e);return-1*Math.atan2(t[1],Math.sqrt(Math.pow(t[0],2)+Math.pow(t[2],2)))};var c={PITCH_DELTA:1,YAW_DELTA_BY_ROLL:2,YAW_DELTA_BY_YAW:3};c[c.PITCH_DELTA]={targetAxis:[0,1,0],meshPoint:[0,0,1]},c[c.YAW_DELTA_BY_ROLL]={targetAxis:[0,1,0],meshPoint:[1,0,0]},c[c.YAW_DELTA_BY_YAW]={targetAxis:[1,0,0],meshPoint:[0,0,1]},u.getRotationDelta=function getRotationDelta(e,t,n){var o=i.default.fromValues(c[n].targetAxis[0],c[n].targetAxis[1],c[n].targetAxis[2]),s=c[n].meshPoint,u=a.default.clone(e),l=a.default.clone(t);a.default.normalize(u,u),a.default.normalize(l,l);var h=i.default.fromValues(0,0,1),d=i.default.fromValues(0,0,1);i.default.transformQuat(h,h,u),i.default.transformQuat(d,d,l),i.default.transformQuat(o,o,l);var f=i.default.dot(o,i.default.cross(i.default.create(),h,d))>0?1:-1,p=i.default.fromValues(s[0],s[1],s[2]),_=void 0;_=n!==c.YAW_DELTA_BY_YAW?i.default.fromValues(0,f,0):i.default.fromValues(f,0,0),i.default.transformQuat(p,p,l),i.default.transformQuat(_,_,l);var g=p,v=_,m=i.default.create();i.default.cross(m,g,v),i.default.normalize(m,m);var y=m[0],w=m[1],R=m[2];d=i.default.fromValues(s[0],s[1],s[2]),i.default.transformQuat(d,d,l),h=i.default.fromValues(s[0],s[1],s[2]),i.default.transformQuat(h,h,u);var E=Math.abs(h[0]*y+h[1]*w+h[2]*R),T=i.default.create();i.default.subtract(T,h,i.default.scale(i.default.create(),m,E));var b=(T[0]*d[0]+T[1]*d[1]+T[2]*d[2])/(i.default.length(T)*i.default.length(d));b>1&&(b=1);var x=Math.acos(b),C=i.default.cross(i.default.create(),d,T);E=y*C[0]+w*C[1]+R*C[2];var P=x*(n!==c.YAW_DELTA_BY_YAW?E>0?1:-1:E<0?1:-1)*f;return r.default.toDegree(P)},t.util=u,t.glMatrix=r.default,t.mat4=s.default,t.quat=a.default,t.vec2=o.default,t.vec3=i.default,t.ROTATE_CONSTANT=c},function(e,t,n){"use strict";t.__esModule=!0;var r={};r.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array;var i=Math.PI/180;r.toRadian=function(e){return e*i},r.toDegree=function(e){return e/i},r.EPSILON=1e-4,t.default=r},function(e,t,n){"use strict";t.__esModule=!0;var r=function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}(n(15));var i={create:function(){var e=new r.default.ARRAY_TYPE(3);return e[0]=0,e[1]=0,e[2]=0,e},fromValues:function(e,t,n){var i=new r.default.ARRAY_TYPE(3);return i[0]=e,i[1]=t,i[2]=n,i},set:function(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},scale:function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e},subtract:function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e},length:function(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)},normalize:function(e,t){var n=t[0],r=t[1],i=t[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o),e},dot:function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},cross:function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],u=n[2];return e[0]=i*u-o*s,e[1]=o*a-r*u,e[2]=r*s-i*a,e},transformQuat:function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],u=n[2],c=n[3],l=c*r+s*o-u*i,h=c*i+u*r-a*o,d=c*o+a*i-s*r,f=-a*r-s*i-u*o;return e[0]=l*c+f*-a+h*-u-d*-s,e[1]=h*c+f*-s+d*-a-l*-u,e[2]=d*c+f*-u+l*-s-h*-a,e},rotateZ:function(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e}};t.default=i},function(e,t,n){"use strict";t.__esModule=!0;(function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}})(n(15));var r={copy:function(e,t){return e[0]=t[0],e[1]=t[1],e}};t.default=r},function(e,t,n){"use strict";t.__esModule=!0;var r=function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}(n(15));var i={create:function(){var e=new r.default.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},clone:function(e){var t=new r.default.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},fromValues:function(e,t,n,i){var o=new r.default.ARRAY_TYPE(4);return o[0]=e,o[1]=t,o[2]=n,o[3]=i,o},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},setAxisAngle:function(e,t,n){n*=.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e},multiply:function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=n[0],u=n[1],c=n[2],l=n[3];return e[0]=r*l+a*s+i*c-o*u,e[1]=i*l+a*u+o*s-r*c,e[2]=o*l+a*c+r*u-i*s,e[3]=a*l-r*s-i*u-o*c,e},rotateX:function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=r*u+a*s,e[1]=i*u+o*s,e[2]=o*u-i*s,e[3]=a*u-r*s,e},rotateY:function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=r*u-o*s,e[1]=i*u+a*s,e[2]=o*u+r*s,e[3]=a*u-i*s,e},conjugate:function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},normalize:function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),e[0]=n*a,e[1]=r*a,e[2]=i*a,e[3]=o*a),e},equals:function(e,t){var n=e[0],i=e[1],o=e[2],a=e[3],s=t[0],u=t[1],c=t[2],l=t[3];return Math.abs(n-s)<=r.default.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-u)<=r.default.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=r.default.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(a-l)<=r.default.EPSILON*Math.max(1,Math.abs(a),Math.abs(l))},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}};t.default=i},function(e,t,n){"use strict";t.__esModule=!0;var r=function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}(n(15));var i={create:function(){var e=new r.default.ARRAY_TYPE(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},rotateX:function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],l=t[9],h=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+c*r,e[5]=a*i+l*r,e[6]=s*i+h*r,e[7]=u*i+d*r,e[8]=c*i-o*r,e[9]=l*i-a*r,e[10]=h*i-s*r,e[11]=d*i-u*r,e},rotateY:function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],s=t[2],u=t[3],c=t[8],l=t[9],h=t[10],d=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-c*r,e[1]=a*i-l*r,e[2]=s*i-h*r,e[3]=u*i-d*r,e[8]=o*r+c*i,e[9]=a*r+l*i,e[10]=s*r+h*i,e[11]=u*r+d*i,e},fromQuat:function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,s=r+r,u=i+i,c=n*a,l=r*a,h=r*s,d=i*a,f=i*s,p=i*u,_=o*a,g=o*s,v=o*u;return e[0]=1-h-p,e[1]=l+v,e[2]=d-g,e[3]=0,e[4]=l-v,e[5]=1-c-p,e[6]=f+_,e[7]=0,e[8]=d+g,e[9]=f-_,e[10]=1-c-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},perspective:function(e,t,n,r,i){var o=1/Math.tan(t/2),a=1/(r-i);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+r)*a,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*r*a,e[15]=0,e}};t.default=i},function(e,t,n){"use strict";t.__esModule=!0;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=_interopRequireDefault(n(3)),o=_interopRequireDefault(n(10)),a=n(14),s=n(6);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var u=function isChromeWithoutDeviceMotion(){var e=!1,t=(0,o.default)(),n=t.browser.version;if("chrome"===t.browser.name&&65===parseInt(n,10)){var r=n.split("."),i=r[2],a=r[3];e=3325===parseInt(i,10)&&parseInt(a,10)<148}return e},c=function(e){function DeviceMotion(){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DeviceMotion);var t=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this));return t._onDeviceMotion=t._onDeviceMotion.bind(t),t._onDeviceOrientation=t._onDeviceOrientation.bind(t),t._onChromeWithoutDeviceMotion=t._onChromeWithoutDeviceMotion.bind(t),t.isWithoutDeviceMotion=u(),t.isAndroid="android"===(0,o.default)().os.name,t.stillGyroVec=a.vec3.create(),t.rawGyroVec=a.vec3.create(),t.adjustedGyroVec=a.vec3.create(),t._timer=null,t.lastDevicemotionTimestamp=0,t._isEnabled=!1,t.enable(),t}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(DeviceMotion,e),DeviceMotion.prototype._onChromeWithoutDeviceMotion=function _onChromeWithoutDeviceMotion(e){var t=e.alpha,n=e.beta,r=e.gamma;null!==t&&(t=(t||0)*Math.PI/180,n=(n||0)*Math.PI/180,r=(r||0)*Math.PI/180,this.trigger("devicemotion",{inputEvent:{deviceorientation:{alpha:t,beta:n,gamma:-r}}}))},DeviceMotion.prototype._onDeviceOrientation=function _onDeviceOrientation(){var e=this;this._timer&&clearTimeout(this._timer),this._timer=setTimeout(function(){(new Date).getTime()-e.lastDevicemotionTimestamp<200&&a.vec3.copy(e.stillGyroVec,e.rawGyroVec)},200)},DeviceMotion.prototype._onDeviceMotion=function _onDeviceMotion(e){var t=!(null==e.rotationRate.alpha),n=!(null==e.accelerationIncludingGravity.x);if(0!==e.interval&&t&&n){var i=r({},e);i.interval=e.interval,i.timeStamp=e.timeStamp,i.type=e.type,i.rotationRate={alpha:e.rotationRate.alpha,beta:e.rotationRate.beta,gamma:e.rotationRate.gamma},i.accelerationIncludingGravity={x:e.accelerationIncludingGravity.x,y:e.accelerationIncludingGravity.y,z:e.accelerationIncludingGravity.z},i.acceleration={x:e.acceleration.x,y:e.acceleration.y,z:e.acceleration.z},this.isAndroid&&(a.vec3.set(this.rawGyroVec,e.rotationRate.alpha||0,e.rotationRate.beta||0,e.rotationRate.gamma||0),a.vec3.subtract(this.adjustedGyroVec,this.rawGyroVec,this.stillGyroVec),this.lastDevicemotionTimestamp=(new Date).getTime(),i.adjustedRotationRate={alpha:this.adjustedGyroVec[0],beta:this.adjustedGyroVec[1],gamma:this.adjustedGyroVec[2]}),this.trigger("devicemotion",{inputEvent:i})}},DeviceMotion.prototype.enable=function enable(){this.isAndroid&&s.window.addEventListener("deviceorientation",this._onDeviceOrientation),this.isWithoutDeviceMotion?s.window.addEventListener("deviceorientation",this._onChromeWithoutDeviceMotion):s.window.addEventListener("devicemotion",this._onDeviceMotion),this._isEnabled=!0},DeviceMotion.prototype.disable=function disable(){s.window.removeEventListener("deviceorientation",this._onDeviceOrientation),s.window.removeEventListener("deviceorientation",this._onChromeWithoutDeviceMotion),s.window.removeEventListener("devicemotion",this._onDeviceMotion),this._isEnabled=!1},DeviceMotion}(i.default);t.default=c},function(e,t,n){"use strict";t.__esModule=!0;var r=_interopRequireDefault(n(12)),i=_interopRequireDefault(n(22));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}i.default.prototype.run_=function(){if(!this.isOrientationInitialized)return this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),void(this.isOrientationInitialized=!0);var e=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS,t=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,e);this.gyroIntegralQ.multiply(t),this.filterQ.copy(this.previousFilterQ),this.filterQ.multiply(t);var n=new r.default.Quaternion;n.copy(this.filterQ),n.inverse(),this.estimatedGravity.set(0,0,-1),this.estimatedGravity.applyQuaternion(n),this.estimatedGravity.normalize(),this.measuredGravity.copy(this.currentAccelMeasurement.sample),this.measuredGravity.normalize();var i=new r.default.Quaternion;i.setFromUnitVectors(this.estimatedGravity,this.measuredGravity),i.inverse();var o=new r.default.Quaternion;o.copy(this.filterQ),o.multiply(i),this.filterQ.slerp(o,1-this.kFilter),this.previousFilterQ.copy(this.filterQ),this.isFilterQuaternionInitialized||(this.isFilterQuaternionInitialized=!0)},i.default.prototype.getOrientation=function(){return this.isFilterQuaternionInitialized?this.filterQ:null},t.default=i.default},function(e,t,n){var r=n(23),i=n(12),o=n(13);function ComplementaryFilter(e){this.kFilter=e,this.currentAccelMeasurement=new r,this.currentGyroMeasurement=new r,this.previousGyroMeasurement=new r,o.isIOS()?this.filterQ=new i.Quaternion(-1,0,0,1):this.filterQ=new i.Quaternion(1,0,0,1),this.previousFilterQ=new i.Quaternion,this.previousFilterQ.copy(this.filterQ),this.accelQ=new i.Quaternion,this.isOrientationInitialized=!1,this.estimatedGravity=new i.Vector3,this.measuredGravity=new i.Vector3,this.gyroIntegralQ=new i.Quaternion}ComplementaryFilter.prototype.addAccelMeasurement=function(e,t){this.currentAccelMeasurement.set(e,t)},ComplementaryFilter.prototype.addGyroMeasurement=function(e,t){this.currentGyroMeasurement.set(e,t);var n=t-this.previousGyroMeasurement.timestampS;o.isTimestampDeltaValid(n)&&this.run_(),this.previousGyroMeasurement.copy(this.currentGyroMeasurement)},ComplementaryFilter.prototype.run_=function(){if(!this.isOrientationInitialized)return this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),void(this.isOrientationInitialized=!0);var e=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS,t=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,e);this.gyroIntegralQ.multiply(t),this.filterQ.copy(this.previousFilterQ),this.filterQ.multiply(t);var n=new i.Quaternion;n.copy(this.filterQ),n.inverse(),this.estimatedGravity.set(0,0,-1),this.estimatedGravity.applyQuaternion(n),this.estimatedGravity.normalize(),this.measuredGravity.copy(this.currentAccelMeasurement.sample),this.measuredGravity.normalize();var r=new i.Quaternion;r.setFromUnitVectors(this.estimatedGravity,this.measuredGravity),r.inverse(),o.isDebug()&&console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",i.radToDeg*o.getQuaternionAngle(r),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var a=new i.Quaternion;a.copy(this.filterQ),a.multiply(r),this.filterQ.slerp(a,1-this.kFilter),this.previousFilterQ.copy(this.filterQ)},ComplementaryFilter.prototype.getOrientation=function(){return this.filterQ},ComplementaryFilter.prototype.accelToQuaternion_=function(e){var t=new i.Vector3;t.copy(e),t.normalize();var n=new i.Quaternion;return n.setFromUnitVectors(new i.Vector3(0,0,-1),t),n.inverse(),n},ComplementaryFilter.prototype.gyroToQuaternionDelta_=function(e,t){var n=new i.Quaternion,r=new i.Vector3;return r.copy(e),r.normalize(),n.setFromAxisAngle(r,e.length()*t),n},e.exports=ComplementaryFilter},function(e,t){function SensorSample(e,t){this.set(e,t)}SensorSample.prototype.set=function(e,t){this.sample=e,this.timestampS=t},SensorSample.prototype.copy=function(e){this.set(e.sample,e.timestampS)},e.exports=SensorSample},function(e,t,n){"use strict";t.__esModule=!0;var r=n(4),i=_interopRequireDefault(r),o=_interopRequireDefault(n(25));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var a=function(e){function RotationPanInput(t,n){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,RotationPanInput);var r=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,t,n));return r._useRotation=!1,r._screenRotationAngle=null,r.setUseRotation(!(!n||!n.useRotation)),r._userDirection=i.default.DIRECTION_ALL,r}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(RotationPanInput,e),RotationPanInput.prototype.setUseRotation=function setUseRotation(e){this._useRotation=e,this._screenRotationAngle&&(this._screenRotationAngle.unref(),this._screenRotationAngle=null),this._useRotation&&(this._screenRotationAngle=new o.default)},RotationPanInput.prototype.connect=function connect(t){this._userDirection=this._direction,this._useRotation&&this._direction&i.default.DIRECTION_ALL&&(this._direction=i.default.DIRECTION_ALL),e.prototype.connect.call(this,t)},RotationPanInput.prototype.getOffset=function getOffset(t,n){if(!1===this._useRotation)return e.prototype.getOffset.call(this,t,n);var r=e.prototype.getOffset.call(this,t,[!0,!0]),o=[0,0],a=this._screenRotationAngle.getRadian(),s=Math.cos(a),u=Math.sin(a);return o[0]=r[0]*s-r[1]*u,o[1]=r[1]*s+r[0]*u,this._userDirection&i.default.DIRECTION_HORIZONTAL?this._userDirection&i.default.DIRECTION_VERTICAL||(o[1]=0):o[0]=0,o},RotationPanInput.prototype.destroy=function destroy(){this._useRotation&&this._screenRotationAngle&&this._screenRotationAngle.unref(),e.prototype.destroy.call(this)},RotationPanInput}(r.PanInput);t.default=a},function(e,t,n){"use strict";t.__esModule=!0;var r=n(6),i=n(14);var o=null,a=0,s=function(){function ScreenRotationAngle(){if(function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ScreenRotationAngle),a++,o)return o;o=this,this._onDeviceOrientation=this._onDeviceOrientation.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._spinR=0,this._screenOrientationAngle=0,r.window.addEventListener("deviceorientation",this._onDeviceOrientation),r.window.addEventListener("orientationchange",this._onOrientationChange)}return ScreenRotationAngle.prototype._onDeviceOrientation=function _onDeviceOrientation(e){if(null!==e.beta&&null!==e.gamma){var t=i.glMatrix.toRadian(e.beta),n=i.glMatrix.toRadian(e.gamma);this._spinR=Math.atan2(Math.cos(t)*Math.sin(n),Math.sin(t))}},ScreenRotationAngle.prototype._onOrientationChange=function _onOrientationChange(e){r.window.screen&&r.window.screen.orientation&&void 0!==r.window.screen.orientation.angle?this._screenOrientationAngle=screen.orientation.angle:void 0!==r.window.orientation&&(this._screenOrientationAngle=r.window.orientation>=0?r.window.orientation:360+r.window.orientation)},ScreenRotationAngle.prototype.getRadian=function getRadian(){return this._spinR+i.glMatrix.toRadian(this._screenOrientationAngle)},ScreenRotationAngle.prototype.unref=function unref(){--a>0||(r.window.removeEventListener("deviceorientation",this._onDeviceOrientation),r.window.removeEventListener("orientationchange",this._onOrientationChange),this._spinR=0,this._screenOrientationAngle=0,o=null,a=0)},ScreenRotationAngle}();t.default=s},function(e,t,n){"use strict";t.__esModule=!0;var r=_interopRequireDefault(n(3)),i=_interopRequireDefault(n(9)),o=_interopRequireDefault(n(25)),a=n(14);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var s=a.vec3.fromValues(0,0,0),u=a.vec3.fromValues(1,0,0),c=a.vec3.fromValues(0,1,0),l=function(e){function DeviceQuaternion(){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DeviceQuaternion);var t=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this));return t._screenRotationAngle=new o.default,t._fusionPoseSensor=new i.default,t._quaternion=a.quat.create(),t._fusionPoseSensor.enable(),t._fusionPoseSensor.on("change",function(e){t._quaternion=e.quaternion,t.trigger("change",{isTrusted:!0})}),t}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(DeviceQuaternion,e),DeviceQuaternion.prototype.getCombinedQuaternion=function getCombinedQuaternion(e,t){var n=this._screenRotationAngle.getRadian(),r=a.vec3.rotateZ(a.vec3.create(),u,s,n),i=a.quat.setAxisAngle(a.quat.create(),c,a.glMatrix.toRadian(-e)),o=a.quat.setAxisAngle(a.quat.create(),r,a.glMatrix.toRadian(-t)),l=a.quat.conjugate(a.quat.create(),this._quaternion),h=a.quat.multiply(a.quat.create(),o,l);return a.quat.multiply(h,h,i),h},DeviceQuaternion.prototype.destroy=function destroy(){this.off(),this._fusionPoseSensor&&(this._fusionPoseSensor.off(),this._fusionPoseSensor.destroy(),this._fusionPoseSensor=null),this._screenRotationAngle&&(this._screenRotationAngle.unref(),this._screenRotationAngle=null)},DeviceQuaternion}(r.default);t.default=l},function(e,t,n){"use strict";t.__esModule=!0;t.GYRO_MODE={NONE:"none",YAWPITCH:"yawPitch",VR:"VR"},t.CONTROL_MODE_VR=1,t.CONTROL_MODE_YAWPITCH=2,t.TOUCH_DIRECTION_NONE=1,t.TOUCH_DIRECTION_YAW=2,t.TOUCH_DIRECTION_PITCH=4,t.TOUCH_DIRECTION_ALL=6,t.MC_DECELERATION=.0014,t.MC_MAXIMUM_DURATION=1e3,t.MC_BIND_SCALE=[.2,.2],t.MIN_FIELD_OF_VIEW=20,t.MAX_FIELD_OF_VIEW=110,t.PAN_SCALE=320,t.DELTA_THRESHOLD=.0375,t.YAW_RANGE_HALF=180,t.PITCH_RANGE_HALF=90,t.CIRCULAR_PITCH_RANGE_HALF=180,t.PINCH_EVENTS="pinchstart pinchmove pinchend",t.KEYMAP={LEFT_ARROW:37,A:65,UP_ARROW:38,W:87,RIGHT_ARROW:39,D:68,DOWN_ARROW:40,S:83}},function(e,t,n){"use strict";t.__esModule=!0,t.VERSION=t.PanoViewer=void 0;var r=function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}(n(29));t.PanoViewer=r.default,t.VERSION="3.1.0",r.default.VERSION="3.1.0"},function(e,t,n){"use strict";t.__esModule=!0;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=_interopRequireDefault(n(3)),o=n(5),a=n(1),s=n(30),u=_interopRequireDefault(n(37)),c=n(42),l=n(14);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h="undefined"==typeof Promise?n(33).Promise:Promise,d=function(e){function PanoViewer(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PanoViewer);var i=_possibleConstructorReturn(this,e.call(this));if(!u.default.isWebGLAvailable())return setTimeout(function(){i.trigger(c.EVENTS.ERROR,{type:c.ERROR_TYPE.NO_WEBGL,message:"no webgl support"})},0),_possibleConstructorReturn(i,i);if(!u.default.isStableWebGL())return setTimeout(function(){i.trigger(c.EVENTS.ERROR,{type:c.ERROR_TYPE.INVALID_DEVICE,message:"blacklisted browser"})},0),_possibleConstructorReturn(i,i);if(n.image&&n.video)return setTimeout(function(){i.trigger(c.EVENTS.ERROR,{type:c.ERROR_TYPE.INVALID_RESOURCE,message:"Specifying multi resouces(both image and video) is not valid."})},0),_possibleConstructorReturn(i,i);i._container=t,i._image=n.image||n.video,i._isVideo=!!n.video,i._projectionType=n.projectionType||c.PROJECTION_TYPE.EQUIRECTANGULAR,i._cubemapConfig=r({order:i._projectionType===c.PROJECTION_TYPE.CUBEMAP?"RLUDBF":"RLUDFB",tileConfig:{flipHirozontal:!1,rotation:0}},n.cubemapConfig),i._width=n.width||parseInt(window.getComputedStyle(t).width,10),i._height=n.height||parseInt(window.getComputedStyle(t).height,10),i._yaw=n.yaw||0,i._pitch=n.pitch||0,i._fov=n.fov||65,i._gyroMode=n.gyroMode||c.GYRO_MODE.YAWPITCH,i._quaternion=null,i._aspectRatio=i._width/i._height;var o=n.fovRange||[30,110],s=PanoViewer._isValidTouchDirection(n.touchDirection)?n.touchDirection:a.YawPitchControl.TOUCH_DIRECTION_ALL,l=r(n,{element:t,yaw:i._yaw,pitch:i._pitch,fov:i._fov,gyroMode:i._gyroMode,fovRange:o,aspectRatio:i._aspectRatio,touchDirection:s});return i._isReady=!1,i._initYawPitchControl(l),i._initRenderer(i._yaw,i._pitch,i._fov,i._projectionType,i._cubemapConfig),i}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(PanoViewer,e),PanoViewer.prototype.getVideo=function getVideo(){return this._isVideo?this._photoSphereRenderer.getContent():null},PanoViewer.prototype.setVideo=function setVideo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e&&this.setImage(e,{projectionType:t.projectionType,isVideo:!0,cubemapConfig:t.cubemapConfig}),this},PanoViewer.prototype.getImage=function getImage(){return this._isVideo?null:this._photoSphereRenderer.getContent()},PanoViewer.prototype.setImage=function setImage(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r({order:"RLUDBF",tileConfig:{flipHirozontal:!1,rotation:0}},t.cubemapConfig),i=!!t.isVideo;return this._image&&this._isVideo!==i?(console.warn("Currently not supporting to change content type(Image <--\x3e Video)"),this):(e&&(this._image=e,this._isVideo=i,this._projectionType=t.projectionType||c.PROJECTION_TYPE.EQUIRECTANGULAR,this._cubemapConfig=n,this._deactivate(),this._initRenderer(this._yaw,this._pitch,this._fov,this._projectionType,this._cubemapConfig)),this)},PanoViewer.prototype.keepUpdate=function keepUpdate(e){return this._photoSphereRenderer.keepUpdate(e),this},PanoViewer.prototype.getProjectionType=function getProjectionType(){return this._projectionType},PanoViewer.prototype._initRenderer=function _initRenderer(e,t,n,r,i){var o=this;this._photoSphereRenderer=new s.PanoImageRenderer(this._image,this._width,this._height,this._isVideo,{initialYaw:e,initialPitch:t,fieldOfView:n,imageType:r,cubemapConfig:i}),this._bindRendererHandler(),this._photoSphereRenderer.bindTexture().then(function(){return o._activate()},function(){o._triggerEvent(c.EVENTS.ERROR,{type:c.ERROR_TYPE.FAIL_BIND_TEXTURE,message:"failed to bind texture"})})},PanoViewer.prototype._bindRendererHandler=function _bindRendererHandler(){var e=this;this._photoSphereRenderer.on(s.PanoImageRenderer.EVENTS.ERROR,function(t){e.trigger(c.EVENTS.ERROR,t)}),this._photoSphereRenderer.on(s.PanoImageRenderer.EVENTS.RENDERING_CONTEXT_LOST,function(t){e._deactivate(),e.trigger(c.EVENTS.ERROR,{type:c.ERROR_TYPE.RENDERING_CONTEXT_LOST,message:"webgl rendering context lost"})})},PanoViewer.prototype._initYawPitchControl=function _initYawPitchControl(e){var t=this;this._yawPitchControl=new a.YawPitchControl(e),this._yawPitchControl.on(c.EVENTS.ANIMATION_END,function(e){t._triggerEvent(c.EVENTS.ANIMATION_END,e)}),this._yawPitchControl.on("change",function(e){t._yaw=e.yaw,t._pitch=e.pitch,t._fov=e.fov,t._quaternion=e.quaternion,t._triggerEvent(c.EVENTS.VIEW_CHANGE,e)})},PanoViewer.prototype._triggerEvent=function _triggerEvent(e,t){var n=t||{};return this.trigger(e,n)},PanoViewer.prototype.setUseZoom=function setUseZoom(e){return"boolean"==typeof e&&this._yawPitchControl.option("useZoom",e),this},PanoViewer.prototype.setUseKeyboard=function setUseKeyboard(e){return this._yawPitchControl.option("useKeyboard",e),this},PanoViewer.prototype.setGyroMode=function setGyroMode(e){return this._yawPitchControl.option("gyroMode",e),this},PanoViewer.prototype.setFovRange=function setFovRange(e){return this._yawPitchControl.option("fovRange",e),this},PanoViewer.prototype.getFovRange=function getFovRange(){return this._yawPitchControl.option("fovRange")},PanoViewer.prototype.updateViewportDimensions=function updateViewportDimensions(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{width:void 0,height:void 0};if(!this._isReady)return this;var t=void 0;void 0!==e.width&&void 0!==e.height||(t=window.getComputedStyle(this._container));var n=e.width||parseInt(t.width,10),r=e.height||parseInt(t.height,10);return n===this._width&&r===this._height?this:(this._width=n,this._height=r,this._aspectRatio=n/r,this._photoSphereRenderer.updateViewportDimensions(n,r),this._yawPitchControl.option("aspectRatio",this._aspectRatio),this._yawPitchControl.updatePanScale({height:r}),this.lookAt({},0),this)},PanoViewer.prototype.getFov=function getFov(){return this._fov},PanoViewer.prototype._getHFov=function _getHFov(){return l.glMatrix.toDegree(2*Math.atan(this._aspectRatio*Math.tan(l.glMatrix.toRadian(this._fov)/2)))},PanoViewer.prototype.getYaw=function getYaw(){return this._yaw},PanoViewer.prototype.getPitch=function getPitch(){return this._pitch},PanoViewer.prototype.getYawRange=function getYawRange(){return this._yawPitchControl.option("yawRange")},PanoViewer.prototype.getPitchRange=function getPitchRange(){return this._yawPitchControl.option("pitchRange")},PanoViewer.prototype.setYawRange=function setYawRange(e){return this._yawPitchControl.option("yawRange",e),this},PanoViewer.prototype.setPitchRange=function setPitchRange(e){return this._yawPitchControl.option("pitchRange",e),this},PanoViewer.prototype.setShowPolePoint=function setShowPolePoint(e){return this._yawPitchControl.option("showPolePoint",e),this},PanoViewer.prototype.lookAt=function lookAt(e,t){if(!this._isReady)return this;var n=void 0!==e.yaw?e.yaw:this._yaw,r=void 0!==e.pitch?e.pitch:this._pitch,i=this._yawPitchControl.option("pitchRange"),o=i[1]-i[0],a=void 0!==e.fov?e.fov:this._fov;return o<a&&(a=o),this._yawPitchControl.lookAt({yaw:n,pitch:r,fov:a},t),0===t&&this._photoSphereRenderer.render(n,r,a),this},PanoViewer.prototype._activate=function _activate(){this._photoSphereRenderer.attachTo(this._container),this._yawPitchControl.enable(),this.updateViewportDimensions(),this._isReady=!0,this._triggerEvent(c.EVENTS.READY),this._startRender()},PanoViewer.prototype._startRender=function _startRender(){this._renderLoop=this._renderLoop.bind(this),this._rafId=window.requestAnimationFrame(this._renderLoop)},PanoViewer.prototype._renderLoop=function _renderLoop(){this._photoSphereRenderer&&(this._quaternion?this._photoSphereRenderer.renderWithQuaternion(this._quaternion,this._fov):this._photoSphereRenderer.render(this._yaw,this._pitch,this._fov)),this._rafId=window.requestAnimationFrame(this._renderLoop)},PanoViewer.prototype._stopRender=function _stopRender(){this._rafId&&(window.cancelAnimationFrame(this._rafId),delete this._rafId)},PanoViewer.prototype._deactivate=function _deactivate(){this._photoSphereRenderer&&(this._photoSphereRenderer.destroy(),this._photoSphereRenderer=null),this._isReady&&(this._yawPitchControl.disable(),this._stopRender(),this._isReady=!1)},PanoViewer._isValidTouchDirection=function _isValidTouchDirection(e){return e===PanoViewer.TOUCH_DIRECTION.NONE||e===PanoViewer.TOUCH_DIRECTION.YAW||e===PanoViewer.TOUCH_DIRECTION.PITCH||e===PanoViewer.TOUCH_DIRECTION.ALL},PanoViewer.prototype.setTouchDirection=function setTouchDirection(e){return PanoViewer._isValidTouchDirection(e)&&this._yawPitchControl.option("touchDirection",e),this},PanoViewer.prototype.getTouchDirection=function getTouchDirection(){return this._yawPitchControl.option("touchDirection")},PanoViewer.prototype.destroy=function destroy(){return this._deactivate(),this._yawPitchControl&&(this._yawPitchControl.destroy(),this._yawPitchControl=null),this},PanoViewer.isWebGLAvailable=function isWebGLAvailable(){return u.default.isWebGLAvailable()},PanoViewer.isGyroSensorAvailable=function isGyroSensorAvailable(e){if(o.DeviceMotionEvent){var t=void 0;h.race([function checkGyro(){return new h(function(e,n){t=function onDeviceMotionChange(t){var n=!(null==t.rotationRate.alpha);e(n)},window.addEventListener("devicemotion",t)})}(),function timeout(){return new h(function(e,t){setTimeout(function(){return e(!1)},1e3)})}()]).then(function(n){window.removeEventListener("devicemotion",t),e&&e(n),PanoViewer.isGyroSensorAvailable=function(e){return e&&e(n),n}})}else e&&e(!1)},PanoViewer}(i.default);t.default=d,d.ERROR_TYPE=c.ERROR_TYPE,d.EVENTS=c.EVENTS,d.PROJECTION_TYPE=c.PROJECTION_TYPE,d.GYRO_MODE=c.GYRO_MODE,d.ProjectionType=c.PROJECTION_TYPE,d.TOUCH_DIRECTION={NONE:a.YawPitchControl.TOUCH_DIRECTION_NONE,YAW:a.YawPitchControl.TOUCH_DIRECTION_YAW,PITCH:a.YawPitchControl.TOUCH_DIRECTION_PITCH,ALL:a.YawPitchControl.TOUCH_DIRECTION_ALL}},function(e,t,n){"use strict";t.__esModule=!0,t.WebGLUtils=t.PanoImageRenderer=void 0;var r=_interopRequireDefault(n(31)),i=_interopRequireDefault(n(37));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}t.PanoImageRenderer=r.default,t.WebGLUtils=i.default},function(e,t,n){"use strict";t.__esModule=!0;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=_interopRequireDefault(n(3)),o=_interopRequireDefault(n(32)),a=_interopRequireDefault(n(36)),s=_interopRequireDefault(n(37)),u=_interopRequireDefault(n(38)),c=_interopRequireDefault(n(40)),l=_interopRequireDefault(n(41)),h=n(14),d=n(5),f=n(42),p=_interopRequireDefault(n(39));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _="undefined"==typeof Promise?n(33).Promise:Promise,g=f.PROJECTION_TYPE,v=d.devicePixelRatio||1;v>2&&(v=2);var m={BIND_TEXTURE:"bindTexture",IMAGE_LOADED:"imageLoaded",ERROR:"error",RENDERING_CONTEXT_LOST:"renderingContextLost",RENDERING_CONTEXT_RESTORE:"renderingContextRestore"},y={INVALID_DEVICE:10,NO_WEBGL:11,FAIL_IMAGE_LOAD:12,RENDERER_ERROR:13},w=function(e){function PanoImageRenderer(t,n,r,i,o,a){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PanoImageRenderer);var s=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this));return s.sphericalConfig=o,s.fieldOfView=o.fieldOfView,s.width=n,s.height=r,s._lastQuaternion=null,s._lastYaw=null,s._lastPitch=null,s._lastFieldOfView=null,s._initialYaw=0,s.pMatrix=h.mat4.create(),s.mvMatrix=h.mat4.create(),h.mat4.perspective(s.pMatrix,h.glMatrix.toRadian(s.fieldOfView),n/r,.1,100),s.textureCoordBuffer=null,s.vertexBuffer=null,s.indexBuffer=null,s.canvas=s._initCanvas(n,r),s._renderingContextAttributes=a,s._image=null,s._imageConfig=null,s._imageIsReady=!1,s._shouldForceDraw=!1,s._keepUpdate=!1,s._onContentLoad=s._onContentLoad.bind(s),s._onContentError=s._onContentError.bind(s),t&&s.setImage({image:t,imageType:o.imageType,isVideo:i,cubemapConfig:o.cubemapConfig}),s}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(PanoImageRenderer,e),PanoImageRenderer.prototype.getContent=function getContent(){return this._image},PanoImageRenderer.prototype.setImage=function setImage(e){var t=e.image,n=e.imageType,i=e.isVideo,s=void 0!==i&&i,u=e.cubemapConfig;return this._imageIsReady=!1,this._isVideo=s,this._imageConfig=r({order:n===g.CUBEMAP?"RLUDBF":"RLUDFB",tileConfig:{flipHirozontal:!1,rotation:0}},u),this._setImageType(n),this._contentLoader&&this._contentLoader.destroy(),s?(this._contentLoader=new a.default,this._keepUpdate=!0):(this._contentLoader=new o.default,this._keepUpdate=!1),this._contentLoader.set(t),this._image=this._contentLoader.getElement(),this._contentLoader.get().then(this._onContentLoad,this._onContentError).catch(function(e){return setTimeout(function(){throw e})})},PanoImageRenderer.prototype._setImageType=function _setImageType(e){var t=this;if(e&&this._imageType!==e){switch(this._imageType=e,this._isCubeMap=e===g.CUBEMAP,this._renderer&&this._renderer.off(),e){case g.CUBEMAP:this._renderer=new u.default;break;case g.CUBESTRIP:this._renderer=new c.default;break;default:this._renderer=new l.default,this._initialYaw=90}this._renderer.on(p.default.EVENTS.ERROR,function(e){t.trigger(m.ERROR,{type:y.RENDERER_ERROR,message:e.message})}),this._initWebGL()}},PanoImageRenderer.prototype._initCanvas=function _initCanvas(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n.style.bottom=0,n.style.left=0,n.style.right=0,n.style.top=0,n.style.margin="auto",n.style.maxHeight="100%",n.style.maxWidth="100%",n.style.outline="none",n.style.position="absolute",this._onWebglcontextlost=this._onWebglcontextlost.bind(this),this._onWebglcontextrestored=this._onWebglcontextrestored.bind(this),n.addEventListener("webglcontextlost",this._onWebglcontextlost),n.addEventListener("webglcontextrestored",this._onWebglcontextrestored),n},PanoImageRenderer.prototype._onContentError=function _onContentError(e){return this._imageIsReady=!1,this._image=null,this.trigger(m.ERROR,{type:y.FAIL_IMAGE_LOAD,message:"failed to load image"}),!1},PanoImageRenderer.prototype._triggerContentLoad=function _triggerContentLoad(){this.trigger(m.IMAGE_LOADED,{content:this._image,isVideo:this._isVideo,projectionType:this._imageType})},PanoImageRenderer.prototype._onContentLoad=function _onContentLoad(e){return this._imageIsReady=!0,this._triggerContentLoad(),!0},PanoImageRenderer.prototype.isImageLoaded=function isImageLoaded(){return!!this._image&&this._imageIsReady&&(!this._isVideo||this._image.readyState>=2)},PanoImageRenderer.prototype.bindTexture=function bindTexture(){var e=this;return new _(function(t,n){e._contentLoader?e._contentLoader.get().then(function(){return e._bindTexture()},n).then(t):n("ImageLoader is not initialized")})},PanoImageRenderer.prototype.attachTo=function attachTo(e){this.detach(),e.appendChild(this.canvas)},PanoImageRenderer.prototype.forceContextLoss=function forceContextLoss(){if(this.hasRenderingContext()){var e=this.context.getExtension("WEBGL_lose_context");e&&e.loseContext()}},PanoImageRenderer.prototype.detach=function detach(){this.canvas.parentElement&&this.canvas.parentElement.removeChild(this.canvas)},PanoImageRenderer.prototype.destroy=function destroy(){this._contentLoader&&this._contentLoader.destroy(),this.detach(),this.forceContextLoss(),this.off(),this.canvas.removeEventListener("webglcontextlost",this._onWebglcontextlost),this.canvas.removeEventListener("webglcontextrestored",this._onWebglcontextrestored)},PanoImageRenderer.prototype.hasRenderingContext=function hasRenderingContext(){return!(!this.context||this.context.isContextLost())&&!(this.context&&!this.context.getProgramParameter(this.shaderProgram,this.context.LINK_STATUS))},PanoImageRenderer.prototype._onWebglcontextlost=function _onWebglcontextlost(e){e.preventDefault(),this.trigger(m.RENDERING_CONTEXT_LOST)},PanoImageRenderer.prototype._onWebglcontextrestored=function _onWebglcontextrestored(e){this._initWebGL(),this.trigger(m.RENDERING_CONTEXT_RESTORE)},PanoImageRenderer.prototype.updateFieldOfView=function updateFieldOfView(e){this.fieldOfView=e,this._updateViewport()},PanoImageRenderer.prototype.updateViewportDimensions=function updateViewportDimensions(e,t){var n=!1;this.width=e,this.height=t;var r=e*v,i=t*v;r!==this.canvas.width&&(this.canvas.width=r,n=!0),i!==this.canvas.height&&(this.canvas.height=i,n=!0),n&&(this._updateViewport(),this._shouldForceDraw=!0)},PanoImageRenderer.prototype._updateViewport=function _updateViewport(){h.mat4.perspective(this.pMatrix,h.glMatrix.toRadian(this.fieldOfView),this.canvas.width/this.canvas.height,.1,100),this.context.viewport(0,0,this.context.drawingBufferWidth,this.context.drawingBufferHeight)},PanoImageRenderer.prototype._initWebGL=function _initWebGL(){var e=void 0;try{if(this._initRenderingContext(),e=this.context,this.updateViewportDimensions(this.width,this.height),this.shaderProgram&&e.deleteProgram(this.shaderProgram),this.shaderProgram=this._initShaderProgram(e),!this.shaderProgram)throw new Error("Failed to intialize shaders: "+s.default.getErrorNameFromWebGLErrorCode(e.getError()));this._initBuffers()}catch(e){return this.trigger(m.ERROR,{type:y.NO_WEBGL,message:"no webgl support"}),this.destroy(),void console.error(e)}e.clearColor(0,0,0,0);var t=this._isCubeMap?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D;this.texture&&e.deleteTexture(this.texture),this.texture=s.default.createTexture(e,t),this._imageType===g.CUBESTRIP&&e.enable(e.CULL_FACE)},PanoImageRenderer.prototype._initRenderingContext=function _initRenderingContext(){if(!this.hasRenderingContext()){if(!window.WebGLRenderingContext)throw new Error("WebGLRenderingContext not available.");if(this.context=s.default.getWebglContext(this.canvas,this._renderingContextAttributes),!this.context)throw new Error("Failed to acquire 3D rendering context")}},PanoImageRenderer.prototype._initShaderProgram=function _initShaderProgram(e){var t=this._renderer.getVertexShaderSource(),n=s.default.createShader(e,e.VERTEX_SHADER,t);if(!n)return!1;var r=this._renderer.getFragmentShaderSource(),i=s.default.createShader(e,e.FRAGMENT_SHADER,r);if(!i)return!1;var o=s.default.createProgram(e,n,i);return o?(e.useProgram(o),o.vertexPositionAttribute=e.getAttribLocation(o,"aVertexPosition"),e.enableVertexAttribArray(o.vertexPositionAttribute),o.pMatrixUniform=e.getUniformLocation(o,"uPMatrix"),o.mvMatrixUniform=e.getUniformLocation(o,"uMVMatrix"),o.samplerUniform=e.getUniformLocation(o,"uSampler"),o.textureCoordAttribute=e.getAttribLocation(o,"aTextureCoord"),e.enableVertexAttribArray(o.textureCoordAttribute),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT),e.uniform1i(o.samplerUniform,0),o):null},PanoImageRenderer.prototype._initBuffers=function _initBuffers(){var e=this._renderer.getVertexPositionData(),t=this._renderer.getIndexData(),n=this._renderer.getTextureCoordData(this._imageConfig),r=this.context;this.vertexBuffer=s.default.initBuffer(r,r.ARRAY_BUFFER,new Float32Array(e),3,this.shaderProgram.vertexPositionAttribute),this.indexBuffer=s.default.initBuffer(r,r.ELEMENT_ARRAY_BUFFER,new Uint16Array(t),1),this.textureCoordBuffer=s.default.initBuffer(r,r.ARRAY_BUFFER,new Float32Array(n),this._isCubeMap?3:2,this.shaderProgram.textureCoordAttribute)},PanoImageRenderer.prototype._bindTexture=function _bindTexture(){if(this._imageType===g.CUBESTRIP){var e=this._renderer.getDimension(this._image),t=e.width,n=e.height,r=t&&n&&t/n!=1.5;this.context.uniform1f(this.context.getUniformLocation(this.shaderProgram,"uIsEAC"),r)}this._renderer.bindTexture(this.context,this.texture,this._image,this._imageConfig),this._shouldForceDraw=!0,this.trigger(m.BIND_TEXTURE)},PanoImageRenderer.prototype._updateTexture=function _updateTexture(){this._renderer.updateTexture(this.context,this._image,this._imageConfig)},PanoImageRenderer.prototype.keepUpdate=function keepUpdate(e){e&&!1===this.isImageLoaded()&&(this._shouldForceDraw=!0),this._keepUpdate=e},PanoImageRenderer.prototype.renderWithQuaternion=function renderWithQuaternion(e,t){if(this.isImageLoaded()&&!(!1===this._keepUpdate&&this._lastQuaternion&&h.quat.exactEquals(this._lastQuaternion,e)&&this.fieldOfView&&this.fieldOfView===t&&!1===this._shouldForceDraw)){void 0!==t&&t!==this.fieldOfView&&this.updateFieldOfView(t);var n=void 0;n=this._isCubeMap?e:h.quat.rotateY(h.quat.create(),e,h.glMatrix.toRadian(90)),this.mvMatrix=h.mat4.fromQuat(h.mat4.create(),n),this._draw(),this._lastQuaternion=h.quat.clone(e),this._shouldForceDraw&&(this._shouldForceDraw=!1)}},PanoImageRenderer.prototype.render=function render(e,t,n){this.isImageLoaded()&&(!1===this._keepUpdate&&null!==this._lastYaw&&this._lastYaw===e&&null!==this._lastPitch&&this._lastPitch===t&&this.fieldOfView&&this.fieldOfView===n&&!1===this._shouldForceDraw||(void 0!==n&&n!==this.fieldOfView&&this.updateFieldOfView(n),h.mat4.identity(this.mvMatrix),h.mat4.rotateX(this.mvMatrix,this.mvMatrix,-h.glMatrix.toRadian(t)),h.mat4.rotateY(this.mvMatrix,this.mvMatrix,-h.glMatrix.toRadian(e-this._initialYaw)),this._draw(),this._lastYaw=e,this._lastPitch=t,this._shouldForceDraw&&(this._shouldForceDraw=!1)))},PanoImageRenderer.prototype._draw=function _draw(){var e=this.context;e.uniformMatrix4fv(this.shaderProgram.pMatrixUniform,!1,this.pMatrix),e.uniformMatrix4fv(this.shaderProgram.mvMatrixUniform,!1,this.mvMatrix),this._isVideo&&this._keepUpdate&&this._updateTexture(),this.indexBuffer&&e.drawElements(e.TRIANGLES,this.indexBuffer.numItems,e.UNSIGNED_SHORT,0)},PanoImageRenderer}(i.default);t.default=w,w.EVENTS=m,w.ERROR_TYPE=y},function(e,t,n){"use strict";t.__esModule=!0;var r=function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}(n(3));var i="undefined"==typeof Promise?n(33).Promise:Promise,o={NONE:0,LOADING:1,LOADED:2,ERROR:3},a="readystatechange",s=function(e){function ImageLoader(t){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ImageLoader);var n=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this));return n._image=null,n._onceHandlers=[],n._loadStatus=o.NONE,t&&n.set(t),n}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(ImageLoader,e),ImageLoader.prototype.get=function get(){var e=this;return new i(function(t,n){e._image?e._loadStatus===o.LOADED?t(e.getElement()):e._loadStatus===o.LOADING?ImageLoader.isMaybeLoaded(e._image)?(e._loadStatus=o.LOADED,t(e.getElement())):e.on(a,function(r){r.type===o.LOADED?t(e.getElement()):n("ImageLoader: failed to load images.")}):n("ImageLoader: failed to load images"):n("ImageLoader: image is not defiend")})},ImageLoader.prototype.set=function set(e){var t=this;this._loadStatus=o.LOADING,this._image=ImageLoader.createElement(e),ImageLoader.isMaybeLoaded(this._image)?this._loadStatus=o.LOADED:this.onceLoaded(this._image,function(){t._loadStatus=o.LOADED,t.trigger(a,{type:o.LOADED})},function(){t._loadStatus=o.ERROR,t.trigger(a,{type:o.ERROR})})},ImageLoader.createElement=function createElement(e){return(e instanceof Array?e:[e]).map(function(e){var t=e;return"string"==typeof e&&((t=new Image).crossOrigin="anonymous",t.src=e),t})},ImageLoader.prototype.getElement=function getElement(){return 1===this._image.length?this._image[0]:this._image},ImageLoader.isMaybeLoaded=function isMaybeLoaded(e){return e instanceof Image?e.complete&&0!==e.naturalWidth:!e.some(function(e){return!e.complete||0===e.naturalWidth})},ImageLoader.prototype.onceLoaded=function onceLoaded(e,t,n){var r=this,o=e instanceof Array?e:[e],a=o.filter(function(e){return!ImageLoader.isMaybeLoaded(e)}).map(function(e){return new i(function(t,n){r._once(e,"load",function(){return t(e)}),r._once(e,"error",function(){return n(e)})})});i.all(a).then(function(e){return t(1===o.length?o[0]:o)},function(e){return n(e)})},ImageLoader.prototype._once=function _once(e,t,n){var r=function fn(r){e.removeEventListener(t,fn),n(r)};e.addEventListener(t,r),this._onceHandlers.push({target:e,type:t,fn:r})},ImageLoader.prototype.getStatus=function getStatus(){return this._loadStatus},ImageLoader.prototype.destroy=function destroy(){this._onceHandlers.forEach(function(e){e.target.removeEventListener(e.type,e.fn)}),this._onceHandlers=[],this._image.src="",this._image=null,this._loadStatus=o.NONE},ImageLoader}(r.default);t.default=s,s.STATUS=o},function(e,t,n){(function(t,n){var r;r=function(){"use strict";function isFunction(e){return"function"==typeof e}var e=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},r=0,i=void 0,o=void 0,a=function asap(e,t){d[r]=e,d[r+1]=t,2===(r+=2)&&(o?o(flush):f())};var s="undefined"!=typeof window?window:void 0,u=s||{},c=u.MutationObserver||u.WebKitMutationObserver,l="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),h="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function useSetTimeout(){var e=setTimeout;return function(){return e(flush,1)}}var d=new Array(1e3);function flush(){for(var e=0;e<r;e+=2){(0,d[e])(d[e+1]),d[e]=void 0,d[e+1]=void 0}r=0}var f=void 0;function then(e,t){var n=this,r=new this.constructor(noop);void 0===r[p]&&makePromise(r);var i=n._state;if(i){var o=arguments[i-1];a(function(){return invokeCallback(i,r,o,n._result)})}else subscribe(n,r,e,t);return r}function resolve$1(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(noop);return resolve(t,e),t}f=l?function useNextTick(){return function(){return t.nextTick(flush)}}():c?function useMutationObserver(){var e=0,t=new c(flush),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}():h?function useMessageChannel(){var e=new MessageChannel;return e.port1.onmessage=flush,function(){return e.port2.postMessage(0)}}():void 0===s?function attemptVertx(){try{var e=Function("return this")().require("vertx");return i=e.runOnLoop||e.runOnContext,function useVertxTimer(){return void 0!==i?function(){i(flush)}:useSetTimeout()}()}catch(e){return useSetTimeout()}}():useSetTimeout();var p=Math.random().toString(36).substring(2);function noop(){}var _=void 0,g=1,v=2,m={error:null};function getThen(e){try{return e.then}catch(e){return m.error=e,m}}function handleMaybeThenable(e,t,n){t.constructor===e.constructor&&n===then&&t.constructor.resolve===resolve$1?function handleOwnThenable(e,t){t._state===g?fulfill(e,t._result):t._state===v?reject(e,t._result):subscribe(t,void 0,function(t){return resolve(e,t)},function(t){return reject(e,t)})}(e,t):n===m?(reject(e,m.error),m.error=null):void 0===n?fulfill(e,t):isFunction(n)?function handleForeignThenable(e,t,n){a(function(e){var r=!1,i=function tryThen(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}}(n,t,function(n){r||(r=!0,t!==n?resolve(e,n):fulfill(e,n))},function(t){r||(r=!0,reject(e,t))},e._label);!r&&i&&(r=!0,reject(e,i))},e)}(e,t,n):fulfill(e,t)}function resolve(e,t){e===t?reject(e,function selfFulfillment(){return new TypeError("You cannot resolve a promise with itself")}()):!function objectOrFunction(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}(t)?fulfill(e,t):handleMaybeThenable(e,t,getThen(t))}function publishRejection(e){e._onerror&&e._onerror(e._result),publish(e)}function fulfill(e,t){e._state===_&&(e._result=t,e._state=g,0!==e._subscribers.length&&a(publish,e))}function reject(e,t){e._state===_&&(e._state=v,e._result=t,a(publishRejection,e))}function subscribe(e,t,n,r){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+g]=n,i[o+v]=r,0===o&&e._state&&a(publish,e)}function publish(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,i=void 0,o=e._result,a=0;a<t.length;a+=3)r=t[a],i=t[a+n],r?invokeCallback(n,r,i,o):i(o);e._subscribers.length=0}}function invokeCallback(e,t,n,r){var i=isFunction(n),o=void 0,a=void 0,s=void 0,u=void 0;if(i){if((o=function tryCatch(e,t){try{return e(t)}catch(e){return m.error=e,m}}(n,r))===m?(u=!0,a=o.error,o.error=null):s=!0,t===o)return void reject(t,function cannotReturnOwn(){return new TypeError("A promises callback cannot return that same promise.")}())}else o=r,s=!0;t._state!==_||(i&&s?resolve(t,o):u?reject(t,a):e===g?fulfill(t,o):e===v&&reject(t,o))}var y=0;function makePromise(e){e[p]=y++,e._state=void 0,e._result=void 0,e._subscribers=[]}var w=function(){function Enumerator(t,n){this._instanceConstructor=t,this.promise=new t(noop),this.promise[p]||makePromise(this.promise),e(n)?(this.length=n.length,this._remaining=n.length,this._result=new Array(this.length),0===this.length?fulfill(this.promise,this._result):(this.length=this.length||0,this._enumerate(n),0===this._remaining&&fulfill(this.promise,this._result))):reject(this.promise,function validationError(){return new Error("Array Methods must be provided an Array")}())}return Enumerator.prototype._enumerate=function _enumerate(e){for(var t=0;this._state===_&&t<e.length;t++)this._eachEntry(e[t],t)},Enumerator.prototype._eachEntry=function _eachEntry(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===resolve$1){var i=getThen(e);if(i===then&&e._state!==_)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(n===R){var o=new n(noop);handleMaybeThenable(o,e,i),this._willSettleAt(o,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},Enumerator.prototype._settledAt=function _settledAt(e,t,n){var r=this.promise;r._state===_&&(this._remaining--,e===v?reject(r,n):this._result[t]=n),0===this._remaining&&fulfill(r,this._result)},Enumerator.prototype._willSettleAt=function _willSettleAt(e,t){var n=this;subscribe(e,void 0,function(e){return n._settledAt(g,t,e)},function(e){return n._settledAt(v,t,e)})},Enumerator}();var R=function(){function Promise(e){this[p]=function nextId(){return y++}(),this._result=this._state=void 0,this._subscribers=[],noop!==e&&("function"!=typeof e&&function needsResolver(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof Promise?function initializePromise(e,t){try{t(function resolvePromise(t){resolve(e,t)},function rejectPromise(t){reject(e,t)})}catch(t){reject(e,t)}}(this,e):function needsNew(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return Promise.prototype.catch=function _catch(e){return this.then(null,e)},Promise.prototype.finally=function _finally(e){var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){throw n})})},Promise}();return R.prototype.then=then,R.all=function all(e){return new w(this,e).promise},R.race=function race(t){var n=this;return e(t)?new n(function(e,r){for(var i=t.length,o=0;o<i;o++)n.resolve(t[o]).then(e,r)}):new n(function(e,t){return t(new TypeError("You must pass an array to race."))})},R.resolve=resolve$1,R.reject=function reject$1(e){var t=new this(noop);return reject(t,e),t},R._setScheduler=function setScheduler(e){o=e},R._setAsap=function setAsap(e){a=e},R._asap=a,R.polyfill=function polyfill(){var e=void 0;if(void 0!==n)e=n;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=R},R.Promise=R,R},e.exports=r()}).call(this,n(34),n(35))},function(e,t){var n,r,i=e.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(e){if(n===setTimeout)return setTimeout(e,0);if((n===defaultSetTimout||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){n=defaultSetTimout}try{r="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){r=defaultClearTimeout}}();var o,a=[],s=!1,u=-1;function cleanUpNextTick(){s&&o&&(s=!1,o.length?a=o.concat(a):u=-1,a.length&&drainQueue())}function drainQueue(){if(!s){var e=runTimeout(cleanUpNextTick);s=!0;for(var t=a.length;t;){for(o=a,a=[];++u<t;)o&&o[u].run();u=-1,t=a.length}o=null,s=!1,function runClearTimeout(e){if(r===clearTimeout)return clearTimeout(e);if((r===defaultClearTimeout||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function Item(e,t){this.fun=e,this.array=t}function noop(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];a.push(new Item(e,t)),1!==a.length||s||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=noop,i.addListener=noop,i.once=noop,i.off=noop,i.removeListener=noop,i.removeAllListeners=noop,i.emit=noop,i.prependListener=noop,i.prependOnceListener=noop,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";t.__esModule=!0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var i="undefined"==typeof Promise?n(33).Promise:Promise,o={HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4,LOADING_FAILED:-1},a={};a[o.HAVE_METADATA]="loadedmetadata",a[o.HAVE_CURRENT_DATA]="loadeddata",a[o.HAVE_FUTURE_DATA]="canplay",a[o.HAVE_ENOUGH_DATA]="canplaythrough";var s=function(){function VideoLoader(e){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,VideoLoader),this._handlers=[],this._sourceCount=0,this._thresholdReadyState=o.HAVE_METADATA,this._thresholdEventName=a[this._thresholdReadyState],this._loadStatus=e&&e.readyState||o.HAVE_NOTHING,this._onerror=this._onerror.bind(this),e&&this.set(e)}return VideoLoader.prototype._onerror=function _onerror(){this._errorCount++,this._errorCount>=this._sourceCount&&(this._loadStatus=o.LOADING_FAILED,this._detachErrorHandler(this._onerror))},VideoLoader.prototype._appendSourceElement=function _appendSourceElement(e){var t=void 0,n=void 0;if("object"===(void 0===e?"undefined":r(e))?(t=e.src,n=e.type):"string"==typeof e&&(t=e),!t)return!1;var i=document.createElement("source");return i.src=t,n&&(i.type=n),this._video.appendChild(i),!0},VideoLoader.prototype.set=function set(e){var t=this;this._reset(),e&&(e instanceof HTMLVideoElement?this._video=e:"string"!=typeof e&&"object"!==(void 0===e?"undefined":r(e))||(this._video=document.createElement("video"),this._video.setAttribute("crossorigin","anonymous"),this._video.setAttribute("webkit-playsinline",""),this._video.setAttribute("playsinline",""),e instanceof Array?e.forEach(function(e){return t._appendSourceElement(e)}):this._appendSourceElement(e),this._sourceCount=this._video.querySelectorAll("source").length,this._sourceCount>0?this._video.readyState<this._thresholdReadyState&&(this._video.load(),this._attachErrorHandler(this._onerror)):this._video=null))},VideoLoader.prototype._attachErrorHandler=function _attachErrorHandler(e){this._video.addEventListener("error",e),this._sources=this._video.querySelectorAll("source"),[].forEach.call(this._sources,function(t){t.addEventListener("error",e)})},VideoLoader.prototype._detachErrorHandler=function _detachErrorHandler(e){this._video.removeEventListener("error",e),[].forEach.call(this._sources,function(t){t.removeEventListener("error",e)})},VideoLoader.prototype.get=function get(){var e=this;return new i(function(t,n){if(e._video)if(e._loadStatus===o.LOADING_FAILED)n("VideoLoader: video source is invalid");else if(e._video.readyState>=e._thresholdReadyState)t(e._video);else{e._attachErrorHandler(function rejector(){e._loadStatus===o.LOADING_FAILED&&(e._detachErrorHandler(rejector),n("VideoLoader: video source is invalid"))}),e._once(e._thresholdEventName,function(){return t(e._video)})}else n("VideoLoader: video is undefined")})},VideoLoader.prototype.getElement=function getElement(){return this._video},VideoLoader.prototype.destroy=function destroy(){this._reset()},VideoLoader.prototype._reset=function _reset(){var e=this;this._handlers.forEach(function(t){e._video.removeEventListener(t.type,t.fn)}),this._handlers=[],this._video=null,this._sourceCount=0,this._errorCount=0},VideoLoader.prototype._once=function _once(e,t){var n=this._video,r=function fn(r){n.removeEventListener(e,fn),t(r)};n.addEventListener(e,r,!0),this._handlers.push({type:e,fn:r})},VideoLoader}();t.default=s},function(e,t,n){"use strict";t.__esModule=!0;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}(n(10));var o={0:"NO_ERROR",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",37442:"CONTEXT_LOST_WEBGL"},a=null,s=function(){function WebGLUtils(){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,WebGLUtils)}return WebGLUtils.createShader=function createShader(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS)?r:(e.deleteShader(r),null)},WebGLUtils.createProgram=function createProgram(e,t,n){var r=e.createProgram();return e.attachShader(r,t),e.attachShader(r,n),e.linkProgram(r),e.getProgramParameter(r,e.LINK_STATUS)?r:(e.deleteProgram(r),null)},WebGLUtils.initBuffer=function initBuffer(e,t,n,r,i){var o=e.createBuffer();return e.bindBuffer(t,o),e.bufferData(t,n,e.STATIC_DRAW),o&&(o.itemSize=r,o.numItems=n.length/r),void 0!==i&&(e.enableVertexAttribArray(i),e.vertexAttribPointer(i,o.itemSize,e.FLOAT,!1,0,0)),o},WebGLUtils.bindBufferToAttribute=function bindBufferToAttribute(e,t,n){null!==t&&null!==n&&(e.bindBuffer(e.ARRAY_BUFFER,t),e.vertexAttribPointer(n,t.itemSize,e.FLOAT,!1,0,0))},WebGLUtils.getWebglContext=function getWebglContext(e,t){var n=["webgl","experimental-webgl","webkit-3d","moz-webgl"],i=null,o=r({preserveDrawingBuffer:!1,antialias:!1},t);function onWebglcontextcreationerror(e){return e.statusMessage}e.addEventListener("webglcontextcreationerror",onWebglcontextcreationerror);for(var a=0;a<n.length;a++){try{i=e.getContext(n[a],o)}catch(e){}if(i)break}return e.removeEventListener("webglcontextcreationerror",onWebglcontextcreationerror),i},WebGLUtils.createTexture=function createTexture(e,t){var n=e.createTexture();return e.bindTexture(t,n),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(t,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(t,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindTexture(t,null),n},WebGLUtils.isWebGLAvailable=function isWebGLAvailable(){if(null===a){var e=document.createElement("canvas"),t=WebGLUtils.getWebglContext(e);if(a=!!t,t){var n=t.getExtension("WEBGL_lose_context");n&&n.loseContext()}}return a},WebGLUtils.isStableWebGL=function isStableWebGL(){var e=(0,i.default)(),t=!0;return"android"===e.os.name&&parseFloat(e.os.version)<=4.3?t=!1:"android"===e.os.name&&4.4===parseFloat(e.os.version)&&"chrome"!==e.browser.name&&(t=!1),t},WebGLUtils.getErrorNameFromWebGLErrorCode=function getErrorNameFromWebGLErrorCode(e){return e in o?o[e]:"UNKNOWN_ERROR"},WebGLUtils.texImage2D=function texImage2D(e,t,n){try{e.texImage2D(t,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)}catch(e){console.error("WebGLUtils.texImage2D error:",e)}},WebGLUtils}();t.default=s},function(e,t,n){"use strict";t.__esModule=!0;var r=_interopRequireDefault(n(10)),i=_interopRequireDefault(n(39)),o=_interopRequireDefault(n(37)),a=n(14);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function CubeRenderer(){return function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CubeRenderer),function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(CubeRenderer,e),CubeRenderer.prototype.getVertexPositionData=function getVertexPositionData(){return CubeRenderer._VERTEX_POSITION_DATA=null!==CubeRenderer._VERTEX_POSITION_DATA?CubeRenderer._VERTEX_POSITION_DATA:[1,-1,1,-1,-1,1,-1,1,1,1,1,1,-1,-1,-1,1,-1,-1,1,1,-1,-1,1,-1,-1,1,-1,1,1,-1,1,1,1,-1,1,1,1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,1,1,-1,-1,1,-1,1,1,1,1,1,1,-1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,1],CubeRenderer._VERTEX_POSITION_DATA},CubeRenderer.prototype.getIndexData=function getIndexData(){if(CubeRenderer._INDEX_DATA)return CubeRenderer._INDEX_DATA;for(var e=[],t=this.getVertexPositionData(),n=0;n<t.length/3;n+=4)e.push(n,n+2,n+1,n,n+3,n+2);return CubeRenderer._INDEX_DATA=e,e},CubeRenderer.extractOrder=function extractOrder(e){return e.order||"RLUDBF"},CubeRenderer.prototype.getTextureCoordData=function getTextureCoordData(e){var t=CubeRenderer.extractOrder(e),n=this.getVertexPositionData(),r=this._extractTileConfig(e);return"BFUDRL".split("").map(function(e){return r[t.indexOf(e)]}).map(function(e,t){for(var r=parseInt(e.rotation/90,10),i=e.flipHorizontal?[0,1,2,3]:[1,0,3,2],o=0;o<Math.abs(r);o++)e.flipHorizontal&&r>0||!e.flipHorizontal&&r<0?i.push(i.shift()):i.unshift(i.pop());for(var a=n.slice(12*t,12*t+12),s=[],u=0;u<4;u++)s[i[u]]=a.splice(0,3);return s}).join().split(",").map(function(e){return parseInt(e,10)})},CubeRenderer.prototype.getVertexShaderSource=function getVertexShaderSource(){return"\n\t\t\tattribute vec3 aVertexPosition;\n\t\t\tattribute vec3 aTextureCoord;\n\t\t\tuniform mat4 uMVMatrix;\n\t\t\tuniform mat4 uPMatrix;\n\t\t\tvarying highp vec3 vVertexDirectionVector;\n\t\t\tvoid main(void) {\n\t\t\t\tgl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n\t\t\t\tvVertexDirectionVector = aTextureCoord;\n\t\t\t}"},CubeRenderer.prototype.getFragmentShaderSource=function getFragmentShaderSource(){return"\n\t\t\tvarying highp vec3 vVertexDirectionVector;\n\t\t\tuniform samplerCube uSampler;\n\t\t\tvoid main(void) {\n\t\t\t\tgl_FragColor = textureCube(uSampler, vVertexDirectionVector);\n\t\t\t}"},CubeRenderer.prototype.updateTexture=function updateTexture(e,t,n){var r={};CubeRenderer.extractOrder(n).split("").forEach(function(e,t){r[e]=t});try{if(t instanceof Array)for(var i=0;i<6;i++){var a=r["RLUDBF"[i]];o.default.texImage2D(e,e.TEXTURE_CUBE_MAP_POSITIVE_X+i,t[a])}else for(var s=this.getMaxCubeMapTextureSize(e,t),u=0;u<6;u++){var c=r["RLUDBF"[u]],l=this.extractTileFromImage(t,c,s);o.default.texImage2D(e,e.TEXTURE_CUBE_MAP_POSITIVE_X+u,l)}}catch(e){this._triggerError(e)}},CubeRenderer.prototype.bindTexture=function bindTexture(e,t,n,r){e.bindTexture(e.TEXTURE_CUBE_MAP,t),this.updateTexture(e,n,r)},CubeRenderer.prototype.getSourceTileSize=function getSourceTileSize(e){var t=this.getDimension(e),n=t.width,r=t.height,i=n/r;return i===1/6?n:6===i?r:i===2/3?n/2:n/3},CubeRenderer.prototype.extractTileFromImage=function extractTileFromImage(e,t,n){var r=this.getDimension(e).width,i=this.getSourceTileSize(e),o=document.createElement("canvas");o.width=n,o.height=n;var a=o.getContext("2d"),s=r/i,u=i*t%(i*s),c=parseInt(t/s,10)*i;return a.drawImage(e,u,c,i,i,0,0,n,n),o},CubeRenderer.prototype.getMaxCubeMapTextureSize=function getMaxCubeMapTextureSize(e,t){var n=(0,r.default)(),i=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),o=this.getSourceTileSize(t);if("ie"===n.browser.name&&11===parseInt(n.browser.version,10)&&!a.util.isPowerOfTwo(o))for(var s=1;s<i;s*=2)if(!(s<o)){o=s;break}return"ios"===n.os.name&&9===parseInt(n.os.version,10)&&(o=1024),"ios"===n.os.name&&8===parseInt(n.os.version,10)&&(o=512),Math.min(i,o)},CubeRenderer}(i.default);t.default=s,s._VERTEX_POSITION_DATA=null,s._INDEX_DATA=null},function(e,t,n){"use strict";t.__esModule=!0;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=_interopRequireDefault(n(3));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var o=(0,_interopRequireDefault(n(10)).default)(),a="ie"===o.browser.name&&"11.0"===o.browser.version,s={ERROR:"error"},u=function(e){function Renderer(){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Renderer);var t=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this));return t._pixelCanvas=null,t._pixelContext=null,t}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Renderer,e),Renderer.prototype.getDimension=function getDimension(e){return{width:e.naturalWidth||e.videoWidth,height:e.naturalHeight||e.videoHeight}},Renderer.prototype._initPixelSource=function _initPixelSource(e){if(a&&e instanceof HTMLVideoElement){var t=this.getDimension(e),n=t.width,r=t.height;this._pixelCanvas=document.createElement("canvas"),this._pixelCanvas.width=n,this._pixelCanvas.height=r,this._pixelContext=this._pixelCanvas.getContext("2d")}},Renderer.prototype._getPixelSource=function _getPixelSource(e){if(!this._pixelCanvas)return e;var t=this.getDimension(e),n=t.width,r=t.height;return this._pixelCanvas.width!==n&&(this._pixelCanvas.width=n),this._pixelCanvas.height!==r&&(this._pixelCanvas.height=r),this._pixelContext.drawImage(e,0,0),this._pixelCanvas},Renderer.prototype._extractTileConfig=function _extractTileConfig(e){var t=Array.isArray(e.tileConfig)?e.tileConfig:Array.apply(void 0,Array(6)).map(function(){return e.tileConfig});return t=t.map(function(e){return r({flipHorizontal:!1,rotation:0},e)})},Renderer.prototype._triggerError=function _triggerError(e){console.error("Renderer Error:",e),this.trigger(s.ERROR,{message:"string"==typeof e?e:e.message})},Renderer}(i.default);t.default=u,u.EVENTS=s},function(e,t,n){"use strict";t.__esModule=!0;var r=_interopRequireDefault(n(39)),i=_interopRequireDefault(n(37));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var o=function(e){function CubeStripRenderer(){return function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CubeStripRenderer),function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(CubeStripRenderer,e),CubeStripRenderer.prototype.getVertexShaderSource=function getVertexShaderSource(){return"\n\t\t\tattribute vec3 aVertexPosition;\n\t\t\tattribute vec2 aTextureCoord;\n\t\t\tuniform mat4 uMVMatrix;\n\t\t\tuniform mat4 uPMatrix;\n\t\t\tvarying highp vec2 vTextureCoord;\n\t\t\tvoid main(void) {\n\t\t\t\tgl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n\t\t\t\tvTextureCoord = aTextureCoord;\n\t\t\t}"},CubeStripRenderer.prototype.getFragmentShaderSource=function getFragmentShaderSource(){return"\n\t\t\t#define PI 3.14159265359\n\n\t\t\tprecision mediump float;\n\t\t\tvarying highp vec2 vTextureCoord;\n\t\t\tuniform sampler2D uSampler;\n\t\t\tuniform bool uIsEAC;\n\n\t\t\tconst vec2 OPERATE_COORDS_RANGE = vec2(-1.0, 1.0);\n\t\t\tconst vec2 TEXTURE_COORDS_RANGE = vec2(0.0, 1.0);\n\t\t\t// vector type is used for initializing values instead of array.\n\t\t\tconst vec4 TEXTURE_DIVISION_X = vec4(0.0, 1.0 / 3.0, 2.0 / 3.0, 1.0);\n\t\t\tconst vec3 TEXTURE_DIVISION_Y = vec3(0.0, 1.0 / 2.0, 1.0);\n\t\t\tconst float EAC_CONST = 2.0 / PI;\n\n\t\t\tfloat scale(vec2 domainRange, vec2 targetRange, float val) {\n\t\t\t\tfloat unit = 1.0 / (domainRange[1] - domainRange[0]);\n\t\t\t\treturn targetRange[0] + (targetRange[1] - targetRange[0]) * (val - domainRange[0]) * unit;\n\t\t\t}\n\n\t\t\tvoid main(void) {\n\t\t\t\tfloat transformedCoordX;\n\t\t\t\tfloat transformedCoordY;\n\n\t\t\t\tif (uIsEAC) {\n\t\t\t\t\tvec2 orgTextureRangeX;\n\t\t\t\t\tvec2 orgTextureRangeY;\n\n\t\t\t\t\t// Apply EAC transform\n\t\t\t\t\tif (vTextureCoord.s >= TEXTURE_DIVISION_X[2]) {\n\t\t\t\t\t\torgTextureRangeX = vec2(TEXTURE_DIVISION_X[2], TEXTURE_DIVISION_X[3]);\n\t\t\t\t\t} else if (vTextureCoord.s >= TEXTURE_DIVISION_X[1]) {\n\t\t\t\t\t\torgTextureRangeX = vec2(TEXTURE_DIVISION_X[1], TEXTURE_DIVISION_X[2]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\torgTextureRangeX = vec2(TEXTURE_DIVISION_X[0], TEXTURE_DIVISION_X[1]);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (vTextureCoord.t >= TEXTURE_DIVISION_Y[1]) {\n\t\t\t\t\t\torgTextureRangeY = vec2(TEXTURE_DIVISION_Y[1], TEXTURE_DIVISION_Y[2]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\torgTextureRangeY = vec2(TEXTURE_DIVISION_Y[0], TEXTURE_DIVISION_Y[1]);\n\t\t\t\t\t}\n\n\t\t\t\t\t// scaling coors by the coordinates following the range from -1.0 to 1.0.\n\t\t\t\t\tfloat px = scale(orgTextureRangeX, OPERATE_COORDS_RANGE, vTextureCoord.s);\n\t\t\t\t\tfloat py = scale(orgTextureRangeY, OPERATE_COORDS_RANGE, vTextureCoord.t);\n\n\t\t\t\t\tfloat qu = EAC_CONST * atan(px) + 0.5;\n\t\t\t\t\tfloat qv = EAC_CONST * atan(py) + 0.5;\n\n\t\t\t\t\t// re-scaling coors by original coordinates ranges\n\t\t\t\t\ttransformedCoordX = scale(TEXTURE_COORDS_RANGE, orgTextureRangeX, qu);\n\t\t\t\t\ttransformedCoordY = scale(TEXTURE_COORDS_RANGE, orgTextureRangeY, qv);\n\t\t\t\t} else {\n\t\t\t\t\t// normal cubemap\n\t\t\t\t\ttransformedCoordX = vTextureCoord.s;\n\t\t\t\t\ttransformedCoordY = vTextureCoord.t;\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = texture2D(uSampler, vec2(transformedCoordX, transformedCoordY));\n\t\t\t}"},CubeStripRenderer.prototype.getVertexPositionData=function getVertexPositionData(){return this._vertices||(this._vertices=[1,-1,1,-1,-1,1,-1,1,1,1,1,1,-1,-1,-1,1,-1,-1,1,1,-1,-1,1,-1,-1,1,-1,1,1,-1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,-1,-1,-1,-1,-1,1,-1,-1,1,-1,1,1,1,1,1,1,-1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,1]),this._vertices},CubeStripRenderer.prototype.getIndexData=function getIndexData(){var e=this;return function(){for(var t=[],n=0;n<e._vertices.length/3;n+=4)t.push(n,n+1,n+2,n,n+2,n+3);return t}()},CubeStripRenderer.prototype.getTextureCoordData=function getTextureCoordData(e){for(var t=this,n=e.order||"RLUDFB",r=[],i=1;i>=0;i--)for(var o=0;o<3;o++){var a=[o/3,i/2,(o+1)/3,i/2,(o+1)/3,(i+1)/2,o/3,(i+1)/2];r.push(a)}var s=this._extractTileConfig(e);return r=r.map(function(e){return t._shrinkCoord(e)}).map(function(e,n){return t._transformCoord(e,s[n])}),"BFUDRL".split("").map(function(e){return n.indexOf(e)}).map(function(e){return r[e]}).reduce(function(e,t){return e.concat(t)},[])},CubeStripRenderer.prototype.updateTexture=function updateTexture(e,t){i.default.texImage2D(e,e.TEXTURE_2D,this._getPixelSource(t))},CubeStripRenderer.prototype.bindTexture=function bindTexture(e,t,n){var r=this.getDimension(n),i=r.width,o=r.height,a=Math.max(i,o),s=e.getParameter(e.MAX_TEXTURE_SIZE);a>s?this._triggerError("Image width("+i+") exceeds device limit("+s+"))"):(this._initPixelSource(n),e.activeTexture(e.TEXTURE0),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.bindTexture(e.TEXTURE_2D,t),this.updateTexture(e,n))},CubeStripRenderer.prototype._transformCoord=function _transformCoord(e,t){var n=e.slice();return t.flipHorizontal&&(n=this._flipHorizontalCoord(n)),t.rotation&&(n=this._rotateCoord(n,t.rotation)),n},CubeStripRenderer.prototype._shrinkCoord=function _shrinkCoord(e){return[e[0]+0,e[1]+0,e[2]-0,e[3]+0,e[4]-0,e[5]-0,e[6]+0,e[7]-0]},CubeStripRenderer.prototype._rotateCoord=function _rotateCoord(e,t){var n=parseInt(t/90,10)%4;if(0===n)return e;var r=void 0,i=[];return n>0?(r=e.splice(0,2*n),i=e.concat(r)):i=(r=e.splice(2*(4+n),2*-n)).concat(e),i},CubeStripRenderer.prototype._flipHorizontalCoord=function _flipHorizontalCoord(e){return[e[2],e[3],e[0],e[1],e[6],e[7],e[4],e[5]]},CubeStripRenderer}(r.default);t.default=o},function(e,t,n){"use strict";t.__esModule=!0;var r=_interopRequireDefault(n(39)),i=_interopRequireDefault(n(37));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var o=function(e){function SphereRenderer(){return function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SphereRenderer),function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(SphereRenderer,e),SphereRenderer.prototype.getVertexPositionData=function getVertexPositionData(){return SphereRenderer._VERTEX_POSITION_DATA},SphereRenderer.prototype.getIndexData=function getIndexData(){return SphereRenderer._INDEX_DATA},SphereRenderer.prototype.getTextureCoordData=function getTextureCoordData(){return SphereRenderer._TEXTURE_COORD_DATA},SphereRenderer.prototype.getVertexShaderSource=function getVertexShaderSource(){return"\n\t\t\tattribute vec3 aVertexPosition;\n\t\t\tattribute vec2 aTextureCoord;\n\t\t\tuniform mat4 uMVMatrix;\n\t\t\tuniform mat4 uPMatrix;\n\t\t\tvarying highp vec2 vTextureCoord;\n\t\t\tvoid main(void) {\n\t\t\t\tgl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n\t\t\t\tvTextureCoord = aTextureCoord;\n\t\t\t}"},SphereRenderer.prototype.getFragmentShaderSource=function getFragmentShaderSource(){return"\n\t\t\tvarying highp vec2 vTextureCoord;\n\t\t\tuniform sampler2D uSampler;\n\t\t\tvoid main(void) {\n\t\t\t\tgl_FragColor = texture2D(\n\t\t\t\t\tuSampler,\n\t\t\t\t\tvec2(vTextureCoord.s, vTextureCoord.t)\n\t\t\t\t);\n\t\t\t}"},SphereRenderer.prototype.updateTexture=function updateTexture(e,t){i.default.texImage2D(e,e.TEXTURE_2D,this._getPixelSource(t))},SphereRenderer.prototype.bindTexture=function bindTexture(e,t,n){var r=this.getDimension(n),i=r.width,o=r.height,a=Math.max(i,o),s=e.getParameter(e.MAX_TEXTURE_SIZE);a>s?this._triggerError("Image width("+i+") exceeds device limit("+s+"))"):(this._initPixelSource(n),e.activeTexture(e.TEXTURE0),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.bindTexture(e.TEXTURE_2D,t),this.updateTexture(e,n))},SphereRenderer._initData=function _initData(){var e=[],t=[],n=[],r=void 0,i=void 0;for(r=0;r<=60;r++){var o=(r/60-.5)*Math.PI,a=Math.sin(o),s=Math.cos(o);for(i=0;i<=60;i++){var u=2*(i/60-.5)*Math.PI,c=Math.sin(u),l=Math.cos(u)*s,h=a,d=c*s,f=i/60,p=r/60;if(e.push(f,p),t.push(2*l,2*h,2*d),60!==i&&60!==r){var _=61*r+i,g=_+60+1;n.push(_,g,_+1,g,g+1,_+1)}}}SphereRenderer._VERTEX_POSITION_DATA=t,SphereRenderer._TEXTURE_COORD_DATA=e,SphereRenderer._INDEX_DATA=n},SphereRenderer}(r.default);t.default=o,o._VERTEX_POSITION_DATA=null,o._TEXTURE_COORD_DATA=null,o._INDEX_DATA=null,o._initData()},function(e,t,n){"use strict";t.__esModule=!0,t.PROJECTION_TYPE=t.ERROR_TYPE=t.EVENTS=t.GYRO_MODE=void 0;var r=n(27);t.GYRO_MODE=r.GYRO_MODE,t.EVENTS={READY:"ready",VIEW_CHANGE:"viewChange",ANIMATION_END:"animationEnd",ERROR:"error"},t.ERROR_TYPE={INVALID_DEVICE:10,NO_WEBGL:11,FAIL_IMAGE_LOAD:12,FAIL_BIND_TEXTURE:13,INVALID_RESOURCE:14,RENDERING_CONTEXT_LOST:15},t.PROJECTION_TYPE={EQUIRECTANGULAR:"equirectangular",CUBEMAP:"cubemap",CUBESTRIP:"cubestrip"}}])});
//# sourceMappingURL=view360.panoviewer.min.js.map