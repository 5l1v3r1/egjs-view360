/*!
 * Copyright (c) 2017 NAVER Corp.
 * @egjs/view360 project is licensed under the MIT license
 * 
 * @egjs/view360 JavaScript library
 * 
 * 
 * @version 2.0.0-rc
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("@egjs/component"),require("@egjs/axes")):"function"==typeof define&&define.amd?define("view360",["@egjs/component","@egjs/axes"],e):"object"==typeof exports?exports.view360=e(require("@egjs/component"),require("@egjs/axes")):(t.eg=t.eg||{},t.eg.view360=e(t.eg.Component,t.eg.Axes))}(this,function(t,e){return function(t){function __webpack_require__(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,__webpack_require__),i.l=!0,i.exports}var e={};return __webpack_require__.m=t,__webpack_require__.c=e,__webpack_require__.i=function(t){return t},__webpack_require__.d=function(t,e,n){__webpack_require__.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},__webpack_require__.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return __webpack_require__.d(e,"a",e),e},__webpack_require__.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=10)}([function(e,n){e.exports=t},function(t,e,n){"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{"default":t}}function quatToVec3(t){var e=s["default"].fromValues(0,0,1);return s["default"].transformQuat(e,e,t),e}function getRotationDelta(t,e,n){var i=s["default"].fromValues(d[n].targetAxis[0],d[n].targetAxis[1],d[n].targetAxis[2]),r=d[n].meshPoint,a=l["default"].clone(t),u=l["default"].clone(e);l["default"].normalize(a,a),l["default"].normalize(u,u);var c=s["default"].fromValues(0,0,1),h=s["default"].fromValues(0,0,1);s["default"].transformQuat(c,c,a),s["default"].transformQuat(h,h,u),s["default"].transformQuat(i,i,u);var f=s["default"].dot(i,s["default"].cross(s["default"].create(),c,h)),p=f>0?1:-1,_=s["default"].fromValues(r[0],r[1],r[2]),m=void 0;m=n!==d.YAW_DELTA_BY_YAW?s["default"].fromValues(0,p,0):s["default"].fromValues(p,0,0),s["default"].transformQuat(_,_,u),s["default"].transformQuat(m,m,u);var y=_,v=m,w=s["default"].create();s["default"].cross(w,y,v),s["default"].normalize(w,w);var g=w[0],x=w[1],b=w[2];h=s["default"].fromValues(r[0],r[1],r[2]),s["default"].transformQuat(h,h,u),c=s["default"].fromValues(r[0],r[1],r[2]),s["default"].transformQuat(c,c,a);var M=Math.abs(c[0]*g+c[1]*x+c[2]*b),P=s["default"].create();s["default"].subtract(P,c,s["default"].scale(s["default"].create(),w,M));var A=(P[0]*h[0]+P[1]*h[1]+P[2]*h[2])/(s["default"].length(P)*s["default"].length(h));A>1&&(A=1);var T=Math.acos(A),R=s["default"].cross(s["default"].create(),h,P);M=g*R[0]+x*R[1]+b*R[2];var C=void 0;C=n!==d.YAW_DELTA_BY_YAW?M>0?1:-1:M<0?1:-1;var E=T*C*p;return o["default"].toDegree(E)}e.__esModule=!0,e.ROTATE_CONSTANT=e.vec3=e.vec2=e.quat=e.mat4=e.glMatrix=e.util=undefined;var i=n(2),o=_interopRequireDefault(i),r=n(23),s=_interopRequireDefault(r),a=n(22),u=_interopRequireDefault(a),c=n(21),l=_interopRequireDefault(c),h=n(20),f=_interopRequireDefault(h),p={};p.isPowerOfTwo=function(t){return"number"!=typeof t?"Not a number":t&&0==(t&t-1)},p.extractYawFromQuat=function(t){var e=quatToVec3(t);return 1*Math.atan2(e[0],e[2])},p.extractPitchFromQuat=function(t){var e=quatToVec3(t);return-1*Math.atan2(e[1],Math.sqrt(Math.pow(e[0],2)+Math.pow(e[2],2)))},p.getQuaternionWithYawPitch=function(t,e){var n=l["default"].create();return l["default"].rotateY(n,n,o["default"].toRadian(t)),l["default"].rotateX(n,n,o["default"].toRadian(e)),n},p.quatToYawPitch=function(t){return{yaw:o["default"].toDegree(p.extractYawFromQuat(t)),pitch:o["default"].toDegree(p.extractPitchFromQuat(t))}},p.yawPitchToPoint=function(t,e){return[Math.tan(t)/Math.cos(e),Math.tan(e)]};var d={PITCH_DELTA:1,YAW_DELTA_BY_ROLL:2,YAW_DELTA_BY_YAW:3};d[d.PITCH_DELTA]={targetAxis:[0,1,0],meshPoint:[0,0,1]},d[d.YAW_DELTA_BY_ROLL]={targetAxis:[0,1,0],meshPoint:[1,0,0]},d[d.YAW_DELTA_BY_YAW]={targetAxis:[1,0,0],meshPoint:[0,0,1]},p.getRotationDelta=getRotationDelta,e.util=p,e.glMatrix=o["default"],e.mat4=f["default"],e.quat=l["default"],e.vec2=u["default"],e.vec3=s["default"],e.ROTATE_CONSTANT=d},function(t,e,n){"use strict";var i={};i.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array;var o=Math.PI/180;i.toRadian=function(t){return t*o},i.toDegree=function(t){return t/o},i.EPSILON=1e-4,t.exports=i},function(t,e,n){"use strict";e.__esModule=!0;var i=[.2,.2],o={LEFT_ARROW:37,A:65,UP_ARROW:38,W:87,RIGHT_ARROW:39,D:68,DOWN_ARROW:40,S:83};e.CONTROL_MODE_VR=1,e.CONTROL_MODE_YAWPITCH=2,e.TOUCH_DIRECTION_NONE=1,e.TOUCH_DIRECTION_YAW=2,e.TOUCH_DIRECTION_PITCH=4,e.TOUCH_DIRECTION_ALL=6,e.MC_DECELERATION=.0014,e.MC_MAXIMUM_DURATION=1e3,e.MC_BIND_SCALE=i,e.MIN_FIELD_OF_VIEW=20,e.MAX_FIELD_OF_VIEW=110,e.PAN_SCALE=320,e.YAW_DELTA_MAX=45,e.DELTA_THRESHOLD=.0375,e.YAW_RANGE_HALF=180,e.PITCH_RANGE_HALF=90,e.PINCH_EVENTS="pinchstart pinchmove pinchend",e.KEYMAP=o},function(t,e,n){"use strict";function toAxis(t,e){return e.reduce(function(e,n,i){return t[i]&&(e[t[i]]=n),e},{})}e.__esModule=!0;var i={};i.toAxis=toAxis,e["default"]=i,e.toAxis=toAxis},function(t,e){var n=window.MathUtil||{};n.degToRad=Math.PI/180,n.radToDeg=180/Math.PI,n.Vector2=function(t,e){this.x=t||0,this.y=e||0},n.Vector2.prototype={constructor:n.Vector2,set:function(t,e){return this.x=t,this.y=e,this},copy:function(t){return this.x=t.x,this.y=t.y,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}},n.Vector3=function(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0},n.Vector3.prototype={constructor:n.Vector3,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var t=this.length();if(0!==t){var e=1/t;this.multiplyScalar(e)}else this.x=0,this.y=0,this.z=0;return this},multiplyScalar:function(t){this.x*=t,this.y*=t,this.z*=t},applyQuaternion:function(t){var e=this.x,n=this.y,i=this.z,o=t.x,r=t.y,s=t.z,a=t.w,u=a*e+r*i-s*n,c=a*n+s*e-o*i,l=a*i+o*n-r*e,h=-o*e-r*n-s*i;return this.x=u*a+h*-o+c*-s-l*-r,this.y=c*a+h*-r+l*-o-u*-s,this.z=l*a+h*-s+u*-r-c*-o,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},crossVectors:function(t,e){var n=t.x,i=t.y,o=t.z,r=e.x,s=e.y,a=e.z;return this.x=i*a-o*s,this.y=o*r-n*a,this.z=n*s-i*r,this}},n.Quaternion=function(t,e,n,i){this.x=t||0,this.y=e||0,this.z=n||0,this.w=i!==undefined?i:1},n.Quaternion.prototype={constructor:n.Quaternion,set:function(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},setFromEulerXYZ:function(t,e,n){var i=Math.cos(t/2),o=Math.cos(e/2),r=Math.cos(n/2),s=Math.sin(t/2),a=Math.sin(e/2),u=Math.sin(n/2);return this.x=s*o*r+i*a*u,this.y=i*a*r-s*o*u,this.z=i*o*u+s*a*r,this.w=i*o*r-s*a*u,this},setFromEulerYXZ:function(t,e,n){var i=Math.cos(t/2),o=Math.cos(e/2),r=Math.cos(n/2),s=Math.sin(t/2),a=Math.sin(e/2),u=Math.sin(n/2);return this.x=s*o*r+i*a*u,this.y=i*a*r-s*o*u,this.z=i*o*u-s*a*r,this.w=i*o*r+s*a*u,this},setFromAxisAngle:function(t,e){var n=e/2,i=Math.sin(n);return this.x=t.x*i,this.y=t.y*i,this.z=t.z*i,this.w=Math.cos(n),this},multiply:function(t){return this.multiplyQuaternions(this,t)},multiplyQuaternions:function(t,e){var n=t.x,i=t.y,o=t.z,r=t.w,s=e.x,a=e.y,u=e.z,c=e.w;return this.x=n*c+r*s+i*u-o*a,this.y=i*c+r*a+o*s-n*u,this.z=o*c+r*u+n*a-i*s,this.w=r*c-n*s-i*a-o*u,this},inverse:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.normalize(),this},normalize:function(){var t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===t?(this.x=0,this.y=0,this.z=0,this.w=1):(t=1/t,this.x=this.x*t,this.y=this.y*t,this.z=this.z*t,this.w=this.w*t),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this.x,i=this.y,o=this.z,r=this.w,s=r*t.w+n*t.x+i*t.y+o*t.z;if(s<0?(this.w=-t.w,this.x=-t.x,this.y=-t.y,this.z=-t.z,s=-s):this.copy(t),s>=1)return this.w=r,this.x=n,this.y=i,this.z=o,this;var a=Math.acos(s),u=Math.sqrt(1-s*s);if(Math.abs(u)<.001)return this.w=.5*(r+this.w),this.x=.5*(n+this.x),this.y=.5*(i+this.y),this.z=.5*(o+this.z),this;var c=Math.sin((1-e)*a)/u,l=Math.sin(e*a)/u;return this.w=r*c+this.w*l,this.x=n*c+this.x*l,this.y=i*c+this.y*l,this.z=o*c+this.z*l,this},setFromUnitVectors:function(){var t,e;return function(i,o){return t===undefined&&(t=new n.Vector3),e=i.dot(o)+1,e<1e-6?(e=0,Math.abs(i.x)>Math.abs(i.z)?t.set(-i.y,i.x,0):t.set(0,-i.z,i.y)):t.crossVectors(i,o),this.x=t.x,this.y=t.y,this.z=t.z,this.w=e,this.normalize(),this}}()},t.exports=n},function(t,e){var n=window.Util||{};n.MIN_TIMESTEP=.001,n.MAX_TIMESTEP=1,n.base64=function(t,e){return"data:"+t+";base64,"+e},n.clamp=function(t,e,n){return Math.min(Math.max(e,t),n)},n.lerp=function(t,e,n){return t+(e-t)*n},n.race=function(t){return Promise.race?Promise.race(t):new Promise(function(e,n){for(var i=0;i<t.length;i++)t[i].then(e,n)})},n.isIOS=function(){var t=/iPad|iPhone|iPod/.test(navigator.platform);return function(){return t}}(),n.isWebViewAndroid=function(){var t=-1!==navigator.userAgent.indexOf("Version")&&-1!==navigator.userAgent.indexOf("Android")&&-1!==navigator.userAgent.indexOf("Chrome");return function(){return t}}(),n.isSafari=function(){var t=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);return function(){return t}}(),n.isFirefoxAndroid=function(){var t=-1!==navigator.userAgent.indexOf("Firefox")&&-1!==navigator.userAgent.indexOf("Android");return function(){return t}}(),n.isLandscapeMode=function(){return 90==window.orientation||-90==window.orientation},n.isTimestampDeltaValid=function(t){return!isNaN(t)&&(!(t<=n.MIN_TIMESTEP)&&!(t>n.MAX_TIMESTEP))},n.getScreenWidth=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},n.getScreenHeight=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},n.requestFullscreen=function(t){if(n.isWebViewAndroid())return!1;if(t.requestFullscreen)t.requestFullscreen();else if(t.webkitRequestFullscreen)t.webkitRequestFullscreen();else if(t.mozRequestFullScreen)t.mozRequestFullScreen();else{if(!t.msRequestFullscreen)return!1;t.msRequestFullscreen()}return!0},n.exitFullscreen=function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else{if(!document.msExitFullscreen)return!1;document.msExitFullscreen()}return!0},n.getFullscreenElement=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},n.linkProgram=function(t,e,n,i){var o=t.createShader(t.VERTEX_SHADER);t.shaderSource(o,e),t.compileShader(o);var r=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(r,n),t.compileShader(r);var s=t.createProgram();t.attachShader(s,o),t.attachShader(s,r);for(var a in i)t.bindAttribLocation(s,i[a],a);return t.linkProgram(s),t.deleteShader(o),t.deleteShader(r),s},n.getProgramUniforms=function(t,e){for(var n={},i=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),o="",r=0;r<i;r++){o=t.getActiveUniform(e,r).name.replace("[0]",""),n[o]=t.getUniformLocation(e,o)}return n},n.orthoMatrix=function(t,e,n,i,o,r,s){var a=1/(e-n),u=1/(i-o),c=1/(r-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*a,t[13]=(o+i)*u,t[14]=(s+r)*c,t[15]=1,t},n.copyArray=function(t,e){for(var n=0,i=t.length;n<i;n++)e[n]=t[n]},n.isMobile=function(){var t=!1;return function(e){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0)}(navigator.userAgent||navigator.vendor||window.opera),t},n.extend=function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},n.safariCssSizeWorkaround=function(t){if(n.isIOS()){var e=t.style.width,i=t.style.height;t.style.width=parseInt(e)+1+"px",t.style.height=parseInt(i)+"px",setTimeout(function(){t.style.width=e,t.style.height=i},100)}window.Util=n,window.canvas=t},n.isDebug=function(){return n.getQueryParameter("debug")},n.getQueryParameter=function(t){var t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),e=new RegExp("[\\?&]"+t+"=([^&#]*)"),n=e.exec(location.search);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))},n.frameDataFromPose=function(){function mat4_perspectiveFromFieldOfView(n,i,o,r){var s=Math.tan(i?i.upDegrees*t:e),a=Math.tan(i?i.downDegrees*t:e),u=Math.tan(i?i.leftDegrees*t:e),c=Math.tan(i?i.rightDegrees*t:e),l=2/(u+c),h=2/(s+a);return n[0]=l,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=h,n[6]=0,n[7]=0,n[8]=-(u-c)*l*.5,n[9]=(s-a)*h*.5,n[10]=r/(o-r),n[11]=-1,n[12]=0,n[13]=0,n[14]=r*o/(o-r),n[15]=0,n}function mat4_fromRotationTranslation(t,e,n){var i=e[0],o=e[1],r=e[2],s=e[3],a=i+i,u=o+o,c=r+r,l=i*a,h=i*u,f=i*c,p=o*u,d=o*c,_=r*c,m=s*a,y=s*u,v=s*c;return t[0]=1-(p+_),t[1]=h+v,t[2]=f-y,t[3]=0,t[4]=h-v,t[5]=1-(l+_),t[6]=d+m,t[7]=0,t[8]=f+y,t[9]=d-m,t[10]=1-(l+p),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function mat4_translate(t,e,n){var i,o,r,s,a,u,c,l,h,f,p,d,_=n[0],m=n[1],y=n[2];return e===t?(t[12]=e[0]*_+e[4]*m+e[8]*y+e[12],t[13]=e[1]*_+e[5]*m+e[9]*y+e[13],t[14]=e[2]*_+e[6]*m+e[10]*y+e[14],t[15]=e[3]*_+e[7]*m+e[11]*y+e[15]):(i=e[0],o=e[1],r=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=e[9],p=e[10],d=e[11],t[0]=i,t[1]=o,t[2]=r,t[3]=s,t[4]=a,t[5]=u,t[6]=c,t[7]=l,t[8]=h,t[9]=f,t[10]=p,t[11]=d,t[12]=i*_+a*m+h*y+e[12],t[13]=o*_+u*m+f*y+e[13],t[14]=r*_+c*m+p*y+e[14],t[15]=s*_+l*m+d*y+e[15]),t}function mat4_invert(t,e){var n=e[0],i=e[1],o=e[2],r=e[3],s=e[4],a=e[5],u=e[6],c=e[7],l=e[8],h=e[9],f=e[10],p=e[11],d=e[12],_=e[13],m=e[14],y=e[15],v=n*a-i*s,w=n*u-o*s,g=n*c-r*s,x=i*u-o*a,b=i*c-r*a,M=o*c-r*u,P=l*_-h*d,A=l*m-f*d,T=l*y-p*d,R=h*m-f*_,C=h*y-p*_,E=f*y-p*m,O=v*E-w*C+g*R+x*T-b*A+M*P;return O?(O=1/O,t[0]=(a*E-u*C+c*R)*O,t[1]=(o*C-i*E-r*R)*O,t[2]=(_*M-m*b+y*x)*O,t[3]=(f*b-h*M-p*x)*O,t[4]=(u*T-s*E-c*A)*O,t[5]=(n*E-o*T+r*A)*O,t[6]=(m*g-d*M-y*w)*O,t[7]=(l*M-f*g+p*w)*O,t[8]=(s*C-a*T+c*P)*O,t[9]=(i*T-n*C-r*P)*O,t[10]=(d*b-_*g+y*v)*O,t[11]=(h*g-l*b-p*v)*O,t[12]=(a*A-s*R-u*P)*O,t[13]=(n*R-i*A+o*P)*O,t[14]=(_*w-d*x-m*v)*O,t[15]=(l*x-h*w+f*v)*O,t):null}function updateEyeMatrices(t,e,o,r,s){mat4_perspectiveFromFieldOfView(t,r?r.fieldOfView:null,s.depthNear,s.depthFar),mat4_fromRotationTranslation(e,o.orientation||n,o.position||i),r&&mat4_translate(e,e,r.offset),mat4_invert(e,e)}var t=Math.PI/180,e=.25*Math.PI,n=new Float32Array([0,0,0,1]),i=new Float32Array([0,0,0]);return function(t,e,n){return!(!t||!e)&&(t.pose=e,t.timestamp=e.timestamp,updateEyeMatrices(t.leftProjectionMatrix,t.leftViewMatrix,e,n.getEyeParameters("left"),n),updateEyeMatrices(t.rightProjectionMatrix,t.rightViewMatrix,e,n.getEyeParameters("right"),n),!0)}}(),n.isInsideCrossDomainIFrame=function(){var t=window.self!==window.top,e=n.getDomainFromUrl(document.referrer),i=n.getDomainFromUrl(window.location.href);return t&&e!==i},n.getDomainFromUrl=function(t){var e;return e=t.indexOf("://")>-1?t.split("/")[2]:t.split("/")[0],e=e.split(":")[0]},t.exports=n},function(t,e,n){"use strict";e.__esModule=!0;var i="undefined"!=typeof window&&window.Math===Math?window:"undefined"!=typeof self&&self.Math===Math?self:Function("return this")();i.Float32Array="undefined"!=typeof i.Float32Array?i.Float32Array:i.Array,e.window=i;e.document=i.document,e.Float32Array=i.Float32Array},function(t,n){t.exports=e},,function(t,e,n){"use strict";e.__esModule=!0,e.YawPitchControl=undefined;var i=n(12),o=function(t){return t&&t.__esModule?t:{"default":t}}(i),r=n(3);o["default"].CONTROL_MODE_VR=r.CONTROL_MODE_VR,o["default"].CONTROL_MODE_YAWPITCH=r.CONTROL_MODE_YAWPITCH,o["default"].TOUCH_DIRECTION_ALL=r.TOUCH_DIRECTION_ALL,o["default"].TOUCH_DIRECTION_YAW=r.TOUCH_DIRECTION_YAW,o["default"].TOUCH_DIRECTION_PITCH=r.TOUCH_DIRECTION_PITCH,o["default"].TOUCH_DIRECTION_NONE=r.TOUCH_DIRECTION_NONE,e.YawPitchControl=o["default"]},,function(t,e,n){"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{"default":t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var i=function(){function defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&defineProperties(t.prototype,e),n&&defineProperties(t,n),t}}(),o=n(0),r=_interopRequireDefault(o),s=n(8),a=_interopRequireDefault(s),u=n(17),c=_interopRequireDefault(u),l=n(19),h=_interopRequireDefault(l),f=n(18),p=_interopRequireDefault(f),d=n(1),_=n(3),m="ontouchstart"in window,y="ondevicemotion"in window,v=function(t){function YawPitchControl(e){_classCallCheck(this,YawPitchControl);var n=_possibleConstructorReturn(this,t.call(this)),i=Object.assign({element:null,yaw:0,pitch:0,fov:65,showPolePoint:!1,useZoom:!0,useKeyboard:!0,touchDirection:_.TOUCH_DIRECTION_ALL,yawRange:[-_.YAW_RANGE_HALF,_.YAW_RANGE_HALF],pitchRange:[-_.PITCH_RANGE_HALF,_.PITCH_RANGE_HALF],fovRange:[30,110],aspectRatio:1},e);return n._element=i.element,n._initialFov=i.fov,n._enabled=!1,n._isAnimating=!1,n._initAxes(i),n.option(i),n}return _inherits(YawPitchControl,t),YawPitchControl.prototype._initAxes=function(t){var e=this,n=YawPitchControl._updateYawRange(t.yawRange,t.fov,t.aspectRatio),i=YawPitchControl._updatePitchRange(t.pitchRange,t.fov,t.showPolePoint),o=n[1]-n[0]<360?[!1,!1]:[!0,!0];this.axesPanInput=new a["default"].PanInput(this._element),this.axesWheelInput=new h["default"](this._element,{scale:4}),this.axesTiltMotionInput=y?new p["default"](this._element):null,this.axesPinchInput=m?new a["default"].PinchInput(this._element,{scale:-1}):null,this.axesMoveKeyInput=new c["default"](this._element,{scale:[-6,6]}),this.axes=new a["default"]({yaw:{range:n,circular:o,bounce:[0,0]},pitch:{range:i,circular:[!1,!1],bounce:[0,0]},fov:{range:t.fovRange,circular:[!1,!1],bounce:[0,0]}},{deceleration:_.MC_DECELERATION,maximumDuration:_.MC_MAXIMUM_DURATION},{yaw:t.yaw,pitch:t.pitch,fov:t.fov}).on({hold:function(t){e.trigger("hold")},change:function(t){0!==t.delta.fov&&(e._setPanScale(t.pos.fov),e._updateControlScale()),e._triggerChange()},release:function(t){0!==t.delta.fov&&(e._setPanScale(t.pos.fov),e._updateControlScale()),e._triggerChange()},animationStart:function(t){},animationEnd:function(t){e.trigger("animationEnd")}})},YawPitchControl.prototype._setPanScale=function(t){if(this._element){var e=parseInt(window.getComputedStyle(this._element).height,10),n=_.MC_BIND_SCALE[0]*t/this._initialFov*_.PAN_SCALE/e;this.axesPanInput.options.scale=[n,n],this.axes.options.deceleration=_.MC_DECELERATION*t/_.MAX_FIELD_OF_VIEW}},YawPitchControl.prototype.option=function(){var t=arguments.length;if(0===t)return this._option();if(1===t&&"string"==typeof(arguments.length<=0?undefined:arguments[0]))return this._option(arguments.length<=0?undefined:arguments[0]);var e=Object.assign({},this.options),n=[];return 1===t?n=Object.keys(arguments.length<=0?undefined:arguments[0]):t>=2&&n.push(arguments.length<=0?undefined:arguments[0]),this._option.apply(this,arguments),this._applyOptions(n,e),this},YawPitchControl.prototype._option=function(t,e){if(arguments.length>=2)return this.options[t]=e,this;if("string"==typeof t)return this.options[t];if(0===arguments.length)return this.options;for(var n in t)this.options[n]=t[n];return this},YawPitchControl.prototype._applyOptions=function(t,e){if(t.some(function(t){return"showPolePoint"===t||"fov"===t||"aspectRatio"===t})&&(this._setYawPitchRange(e),this._updateControlScale()),t.some(function(t){return"yawRange"===t||"pitchRange"===t})&&this._updateControlScale(),t.some(function(t){return"fovRange"===t})){var n=this.options.fovRange,i=this.axes.get().fov,o=this.axes.get().fov;d.vec2.copy(this.axes.axis.fov.range,n),o<n[0]?o=n[0]:i>n[1]&&(o=n[1]),i!==o&&(this.axes.setTo({fov:o}),this._updateControlScale())}if(t.some(function(t){return"useKeyboard"===t})){this.options.useKeyboard?this.axes.connect(["yaw","pitch"],this.axesMoveKeyInput):this.axes.disconnect(this.axesMoveKeyInput)}if(t.some(function(t){return"useZoom"===t})){this.options.useZoom?(this.axes.connect(["fov"],this.axesWheelInput),this.axesPinchInput&&this.axes.connect(["fov"],this.axesPinchInput)):(this.axes.disconnect(this.axesWheelInput),this.axesPinchInput&&this.axes.disconnect(this.axesPinchInput))}},YawPitchControl.prototype._setYawPitchRange=function(t){var e=t.yawRange,n=t.pitchRange,i=[],o=[],r=this.axes.get().fov,s=YawPitchControl.adjustAspectRatio(this.options.aspectRatio),a=r*s;i=this.option("yawRange"),i[1]-i[0]<a&&this.option("yawRange",e),o=this.option("pitchRange"),o[1]-o[0]<r&&this.option("pitchRange",n)},YawPitchControl.prototype._updateControlScale=function(){var t=this.options,e=this.axes.get().fov,n=YawPitchControl._updatePitchRange(t.pitchRange,e,t.showPolePoint),i=YawPitchControl._updateYawRange(t.yawRange,e,t.aspectRatio),o=this.axes.get(),r=o.yaw,s=o.pitch;return d.vec2.copy(this.axes.axis.yaw.range,i),d.vec2.copy(this.axes.axis.pitch.range,n),this.axes.axis.yaw.circular=i[1]-i[0]<360?[!1,!1]:[!0,!0],r<i[0]?r=i[0]:r>i[1]&&(r=i[1]),s<n[0]?s=n[0]:s>n[1]&&(s=n[1]),this.axes.setTo({yaw:r,pitch:s}),this},YawPitchControl._updatePitchRange=function(t,e,n){var i=t[1]-t[0],o=e/2,r=i<180;return n&&!r?t.map(function(t){return+t.toFixed(5)}):[t[0]+o,t[1]-o].map(function(t){return+t.toFixed(5)})},YawPitchControl._updateYawRange=function(t,e,n){var i=t[1]-t[0];if(i>=360)return t.map(function(t){return+t.toFixed(5)});var o=1,r=YawPitchControl.adjustAspectRatio(n),s=e/2*r;return i>290?o=.794:i>125&&(o=.98),[t[0]*o+s,t[1]*o-s].map(function(t){return+t.toFixed(5)})},YawPitchControl.prototype._triggerChange=function(){var t=this.axes.get(),e=this.options,n={targetElement:e.element};n.yaw=t.yaw,n.pitch=t.pitch,n.fov=t.fov,this.trigger("change",n)},YawPitchControl.adjustAspectRatio=function(t){for(var e=[.52,.54,.563,.57,.584,.59,.609,.67,.702,.72,.76,.78,.82,.92,.97,1,1.07,1.14,1.19,1.25,1.32,1.38,1.4,1.43,1.53,1.62,1.76,1.77,1.86,1.96,2.26,2.3,2.6,3,5,6],n=[.51,.54,.606,.56,.628,.63,.647,.71,.736,.757,.78,.77,.8,.89,.975,1,1.07,1.1,1.15,1.18,1.22,1.27,1.3,1.33,1.39,1.45,1.54,1.55,1.58,1.62,1.72,1.82,1.92,2,2.24,2.3],i=-1,o=0;o<e.length-1;o++)if(e[o]<=t&&e[o+1]>=t){i=o;break}if(-1===i)return e[0]>t?n[0]:n[n[0].length-1];var r=e[i],s=e[i+1],a=n[i],u=n[i+1];return YawPitchControl.lerp(a,u,(t-r)/(s-r))},YawPitchControl.lerp=function(t,e,n){return t+n*(e-t)},YawPitchControl.prototype.enable=function(){return this._enabled?this:(this.axes.connect(["yaw","pitch"],this.axesPanInput),this.axesTiltMotionInput&&this.axes.connect(["yaw","pitch"],this.axesTiltMotionInput),this._applyOptions(Object.keys(this.options),this.options),this._enabled=!0,this)},YawPitchControl.prototype.disable=function(t){return this._enabled?(t||this._resetOrientation(),this.axes.disconnect(),this._enabled=!1,this):this},YawPitchControl.prototype._resetOrientation=function(){var t=this.options;return this.axes.setTo({yaw:t.yaw,pitch:t.pitch,fov:t.fov}),this},YawPitchControl.prototype.lookAt=function(t,e,n){var i=t.yaw,o=t.pitch,r=t.fov,s=this.axes.get();if(!n||i!==s.yaw||o!==s.pitch||r!==s.fov){var a=i===undefined?0:i-s.yaw,u=o===undefined?0:o-s.pitch,c=r===undefined?0:r-s.fov;this.axes.setBy({yaw:a,pitch:u,fov:c},e)}},YawPitchControl.prototype.get=function(){return this.axes.get()},YawPitchControl.prototype.getYaw=function(){return this.axes.get().yaw},YawPitchControl.prototype.getPitch=function(){return this.axes.get().pitch},YawPitchControl.prototype.getFov=function(){return this.axes.get().fov},YawPitchControl.prototype.destroy=function(){this.axes&&this.axes.destroy(),this.axisPanInput&&this.axisPanInput.destroy(),this.axesWheelInput&&this.axesWheelInput.destroy(),this.axesTiltMotionInput&&this.axesTiltMotionInput.destroy(),this.axesPinchInput&&this.axesPinchInput.destroy(),this.axesMoveKeyInput&&this.axesMoveKeyInput.destroy()},i(YawPitchControl,null,[{key:"YAW_DELTA_MAX",get:function(){return _.YAW_DELTA_MAX}}]),YawPitchControl}(r["default"]);v.VERSION="2.0.0-rc",e["default"]=v},,,function(t,e,n){"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var i=n(0),o=function(t){return t&&t.__esModule?t:{"default":t}}(i),r=n(1),s=n(7),a=function(t){function DeviceMotion(){_classCallCheck(this,DeviceMotion);var e=_possibleConstructorReturn(this,t.call(this));return e._onDeviceMotion=e._onDeviceMotion.bind(e),e._onDeviceOrientation=e._onDeviceOrientation.bind(e),e.isAndroid=-1!==s.window.navigator.userAgent.indexOf("Android"),e.stillGyroVec=r.vec3.create(),e.rawGyroVec=r.vec3.create(),e.adjustedGyroVec=r.vec3.create(),e._timer=null,e.lastDevicemotionTimestamp=0,e._isEnabled=!1,e.enable(),e}return _inherits(DeviceMotion,t),DeviceMotion.prototype._onDeviceOrientation=function(){var t=this;this._timer&&clearTimeout(this._timer),this._timer=setTimeout(function(){(new Date).getTime()-t.lastDevicemotionTimestamp<200&&r.vec3.copy(t.stillGyroVec,t.rawGyroVec)},200)},DeviceMotion.prototype._onDeviceMotion=function(t){0!==t.interval&&(this.isAndroid&&(r.vec3.set(this.rawGyroVec,t.rotationRate.alpha||0,t.rotationRate.beta||0,t.rotationRate.gamma||0),r.vec3.subtract(this.adjustedGyroVec,this.rawGyroVec,this.stillGyroVec),this.lastDevicemotionTimestamp=(new Date).getTime(),t.adjustedRotationRate={alpha:this.adjustedGyroVec[0],beta:this.adjustedGyroVec[1],gamma:this.adjustedGyroVec[2]}),this.trigger("devicemotion",t))},DeviceMotion.prototype.enable=function(){this.isAndroid&&s.window.addEventListener("deviceorientation",this._onDeviceOrientation),s.window.addEventListener("devicemotion",this._onDeviceMotion),this._isEnabled=!0},DeviceMotion.prototype.disable=function(){this.isAndroid&&s.window.removeEventListener("deviceorientation",this._onDeviceOrientation),s.window.removeEventListener("devicemotion",this._onDeviceMotion),this._isEnabled=!1},DeviceMotion.prototype.isEnabled=function(){return this._isEnabled},DeviceMotion}(o["default"]);e["default"]=a},function(t,e,n){"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{"default":t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var i=n(0),o=_interopRequireDefault(i),r=n(25),s=_interopRequireDefault(r),a=n(26),u=_interopRequireDefault(a),c=n(5),l=_interopRequireDefault(c),h=n(6),f=_interopRequireDefault(h),p=n(7),d=n(1),_=n(15),m=_interopRequireDefault(_),y=.98,v=.04,w=function(t){function FusionPoseSensor(){_classCallCheck(this,FusionPoseSensor);var e=_possibleConstructorReturn(this,t.call(this));return e.deviceMotion=new m["default"],e.accelerometer=new l["default"].Vector3,e.gyroscope=new l["default"].Vector3,e._onDeviceMotionChange=e._onDeviceMotionChange.bind(e),e._onScreenOrientationChange=e._onScreenOrientationChange.bind(e),e.filter=new s["default"](y),e.posePredictor=new u["default"](v),e.filterToWorldQ=new l["default"].Quaternion,e.isFirefoxAndroid=f["default"].isFirefoxAndroid(),e.isIOS=f["default"].isIOS(),e._isEnabled=!1,e.isIOS?e.filterToWorldQ.setFromAxisAngle(new l["default"].Vector3(1,0,0),Math.PI/2):e.filterToWorldQ.setFromAxisAngle(new l["default"].Vector3(1,0,0),-Math.PI/2),e.inverseWorldToScreenQ=new l["default"].Quaternion,e.worldToScreenQ=new l["default"].Quaternion,e.originalPoseAdjustQ=new l["default"].Quaternion,e.originalPoseAdjustQ.setFromAxisAngle(new l["default"].Vector3(0,0,1),-p.window.orientation*Math.PI/180),e._setScreenTransform(),f["default"].isLandscapeMode()&&e.filterToWorldQ.multiply(e.inverseWorldToScreenQ),e.resetQ=new l["default"].Quaternion,e.deviceMotion.on("devicemotion",e._onDeviceMotionChange),e.enable(),e}return _inherits(FusionPoseSensor,t),FusionPoseSensor.prototype.enable=function(){this.isEnabled()||(this.deviceMotion.enable(),this._isEnabled=!0,p.window.addEventListener("orientationchange",this._onScreenOrientationChange))},FusionPoseSensor.prototype.disable=function(){this.isEnabled()&&(this.deviceMotion.disable(),this._isEnabled=!1,p.window.removeEventListener("orientationchange",this._onScreenOrientationChange))},FusionPoseSensor.prototype.isEnabled=function(){return this._isEnabled},FusionPoseSensor.prototype.destroy=function(){this.disable(),this.deviceMotion=null},FusionPoseSensor.prototype._triggerChange=function(){var t=this.getOrientation();if(!this._prevOrientation)return void(this._prevOrientation=t);d.quat.equals(this._prevOrientation,t)||this.trigger("change",{quaternion:t})},FusionPoseSensor.prototype.getOrientation=function(){var t=this.filter.getOrientation(),e=this._convertFusionToPredicted(t);return e=d.quat.fromValues(e.x,e.y,e.z,e.w),d.quat.normalize(e,e)},FusionPoseSensor.prototype._convertFusionToPredicted=function(t){this.predictedQ=this.posePredictor.getPrediction(t,this.gyroscope,this.previousTimestampS);var e=new l["default"].Quaternion;return e.copy(this.filterToWorldQ),e.multiply(this.resetQ),e.multiply(this.predictedQ),e.multiply(this.worldToScreenQ),e},FusionPoseSensor.prototype.resetPose=function(){this.resetQ.copy(this.filter.getOrientation()),this.resetQ.x=0,this.resetQ.y=0,this.resetQ.z*=-1,this.resetQ.normalize(),f["default"].isLandscapeMode()&&this.resetQ.multiply(this.inverseWorldToScreenQ),this.resetQ.multiply(this.originalPoseAdjustQ)},FusionPoseSensor.prototype._onDeviceMotionChange=function(t){var e=t.accelerationIncludingGravity,n=t.adjustedRotationRate||t.rotationRate,i=t.timeStamp/1e3;this.isFirefoxAndroid&&(i/=1e3),this.accelerometer.set(-e.x,-e.y,-e.z),this.gyroscope.set(n.alpha,n.beta,n.gamma),(this.isIOS||this.isFirefoxAndroid)&&this.gyroscope.multiplyScalar(Math.PI/180),this.filter.addAccelMeasurement(this.accelerometer,i),this.filter.addGyroMeasurement(this.gyroscope,i),this._triggerChange(),this.previousTimestampS=i},FusionPoseSensor.prototype._onScreenOrientationChange=function(t){this._setScreenTransform(p.window.orientation)},FusionPoseSensor.prototype._setScreenTransform=function(){switch(this.worldToScreenQ.set(0,0,0,1),p.window.orientation){case 0:break;case 90:this.worldToScreenQ.setFromAxisAngle(new l["default"].Vector3(0,0,1),-.5*Math.PI);break;case-90:this.worldToScreenQ.setFromAxisAngle(new l["default"].Vector3(0,0,1),.5*Math.PI);break;case 180:this.worldToScreenQ.setFromAxisAngle(new l["default"].Vector3(0,0,1),-1*Math.PI)}this.inverseWorldToScreenQ.copy(this.worldToScreenQ),this.inverseWorldToScreenQ.inverse()},FusionPoseSensor}(o["default"]);e["default"]=w},function(t,e,n){"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var i=n(0),o=function(t){return t&&t.__esModule?t:{"default":t}}(i),r=n(3),s=n(4),a=function(t){function MoveKeyInput(e,n){_classCallCheck(this,MoveKeyInput);var i=_possibleConstructorReturn(this,t.call(this));return i.element=e,i.options=Object.assign({scale:[1,1],threshold:0},n),i._onKeydown=i._onKeydown.bind(i),i}return _inherits(MoveKeyInput,t),MoveKeyInput.prototype.mapAxes=function(t){this.axes=t},MoveKeyInput.prototype.connect=function(t){return this.observer?this:(this.observer=t,"0"!==this.element.getAttribute("tabindex")&&this.element.setAttribute("tabindex","0"),this._attachEvent(),this)},MoveKeyInput.prototype.disconnect=function(){return this.observer?(this.observer=null,this._dettachEvent(),this):this},MoveKeyInput.prototype.destroy=function(){this.disconnect(),this.element=null,this.options=null,this.axes=null},MoveKeyInput.prototype._onKeydown=function(t){var e=!0,n=void 0,i=t;switch(i.keyCode){case r.KEYMAP.LEFT_ARROW:case r.KEYMAP.A:n=[-this.options.scale[0],0];break;case r.KEYMAP.RIGHT_ARROW:case r.KEYMAP.D:n=[this.options.scale[0],0];break;case r.KEYMAP.UP_ARROW:case r.KEYMAP.W:n=[0,this.options.scale[1]];break;case r.KEYMAP.DOWN_ARROW:case r.KEYMAP.S:n=[0,-this.options.scale[1]];break;default:e=!1}e&&(this.observer.change(this,t,(0,s.toAxis)(this.axes,n)),i.preventDefault())},MoveKeyInput.prototype._attachEvent=function(){this.element.addEventListener("keydown",this._onKeydown,!1)},MoveKeyInput.prototype._dettachEvent=function(){this.element.removeEventListener("keydown",this._onKeydown,!1)},MoveKeyInput}(o["default"]);e["default"]=a},function(t,e,n){"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{"default":t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function getDeltaYaw(t,e){var n=u.util.getRotationDelta(t,e,u.ROTATE_CONSTANT.YAW_DELTA_BY_YAW);return u.util.getRotationDelta(t,e,u.ROTATE_CONSTANT.YAW_DELTA_BY_ROLL)*Math.sin(u.util.extractPitchFromQuat(e))+n}function getDeltaPitch(t,e){return u.util.getRotationDelta(t,e,u.ROTATE_CONSTANT.PITCH_DELTA)}e.__esModule=!0;var i=n(0),o=_interopRequireDefault(i),r=n(4),s=n(16),a=_interopRequireDefault(s),u=n(1),c=function(t){function TiltMotionInput(e,n){_classCallCheck(this,TiltMotionInput);var i=_possibleConstructorReturn(this,t.call(this));return i.element=e,i._prevQuaternion=null,i._quaternion=null,i.fusionPoseSensor=null,i.options=Object.assign({scale:1,threshold:0},n),i._onPoseChange=i._onPoseChange.bind(i),i}return _inherits(TiltMotionInput,t),TiltMotionInput.prototype.mapAxes=function(t){this.axes=t},TiltMotionInput.prototype.connect=function(t){return this.observer?this:(this.observer=t,this.fusionPoseSensor=new a["default"],this.fusionPoseSensor.enable(),this._attachEvent(),this)},TiltMotionInput.prototype.disconnect=function(){return this.observer?(this._dettachEvent(),this.fusionPoseSensor.disable(),this.fusionPoseSensor.destroy(),this.fusionPoseSensor=null,this.observer=null,this):this},TiltMotionInput.prototype.destroy=function(){this.disconnect(),this.element=null,this.options=null,this.axes=null,this._prevQuaternion=null,this._quaternion=null},TiltMotionInput.prototype._onPoseChange=function(t){if(!this._prevQuaternion)return this._prevQuaternion=u.quat.clone(t.quaternion),void(this._quaternion=u.quat.clone(t.quaternion));u.quat.copy(this._prevQuaternion,this._quaternion),u.quat.copy(this._quaternion,t.quaternion),this.observer.change(this,t,(0,r.toAxis)(this.axes,[getDeltaYaw(this._prevQuaternion,this._quaternion),getDeltaPitch(this._prevQuaternion,this._quaternion)]))},TiltMotionInput.prototype._attachEvent=function(){this.fusionPoseSensor.on("change",this._onPoseChange)},TiltMotionInput.prototype._dettachEvent=function(){this.fusionPoseSensor.off("change",this._onPoseChange)},TiltMotionInput}(o["default"]);e["default"]=c},function(t,e,n){"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var i=n(0),o=function(t){return t&&t.__esModule?t:{"default":t}}(i),r=n(4),s=function(t){function WheelInput(e,n){_classCallCheck(this,WheelInput);var i=_possibleConstructorReturn(this,t.call(this));return i.element=e,i.options=Object.assign({scale:1,threshold:0},n),i._onWheel=i._onWheel.bind(i),i}return _inherits(WheelInput,t),WheelInput.prototype.mapAxes=function(t){this.axes=t},WheelInput.prototype.connect=function(t){return this.observer?this:(this.observer=t,this._attachEvent(),this)},WheelInput.prototype.disconnect=function(){return this.observer?(this.observer=null,this._dettachEvent(),this):this},WheelInput.prototype.destroy=function(){this.disconnect(),this.element=null,this.options=null,this.axes=null},WheelInput.prototype._onWheel=function(t){t.preventDefault(),0!==t.deltaY&&this.observer.change(this,t,(0,r.toAxis)(this.axes,[(t.deltaY<0?-1:1)*this.options.scale]))},WheelInput.prototype._attachEvent=function(){this.element.addEventListener("wheel",this._onWheel,!1)},WheelInput.prototype._dettachEvent=function(){this.element.removeEventListener("wheel",this._onWheel,!1)},WheelInput}(o["default"]);e["default"]=s},function(t,e,n){"use strict";var i=n(2),o=function(t){return t&&t.__esModule?t:{"default":t}}(i),r={};r.create=function(){var t=new o["default"].ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.rotateX=function(t,e,n){var i=Math.sin(n),o=Math.cos(n),r=e[4],s=e[5],a=e[6],u=e[7],c=e[8],l=e[9],h=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=r*o+c*i,t[5]=s*o+l*i,t[6]=a*o+h*i,t[7]=u*o+f*i,t[8]=c*o-r*i,t[9]=l*o-s*i,t[10]=h*o-a*i,t[11]=f*o-u*i,t},r.rotateY=function(t,e,n){var i=Math.sin(n),o=Math.cos(n),r=e[0],s=e[1],a=e[2],u=e[3],c=e[8],l=e[9],h=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=r*o-c*i,t[1]=s*o-l*i,t[2]=a*o-h*i,t[3]=u*o-f*i,t[8]=r*i+c*o,t[9]=s*i+l*o,t[10]=a*i+h*o,t[11]=u*i+f*o,t},r.fromQuat=function(t,e){var n=e[0],i=e[1],o=e[2],r=e[3],s=n+n,a=i+i,u=o+o,c=n*s,l=i*s,h=i*a,f=o*s,p=o*a,d=o*u,_=r*s,m=r*a,y=r*u;return t[0]=1-h-d,t[1]=l+y,t[2]=f-m,t[3]=0,t[4]=l-y,t[5]=1-c-d,t[6]=p+_,t[7]=0,t[8]=f+m,t[9]=p-_,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.perspective=function(t,e,n,i,o){var r=1/Math.tan(e/2),s=1/(i-o);return t[0]=r/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(o+i)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*o*i*s,t[15]=0,t},t.exports=r},function(t,e,n){"use strict";var i=n(2),o=function(t){return t&&t.__esModule?t:{"default":t}}(i),r={};r.create=function(){var t=new o["default"].ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},r.clone=function(t){var e=new o["default"].ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},r.fromValues=function(t,e,n,i){var r=new o["default"].ARRAY_TYPE(4);return r[0]=t,r[1]=e,r[2]=n,r[3]=i,r},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},r.multiply=function(t,e,n){var i=e[0],o=e[1],r=e[2],s=e[3],a=n[0],u=n[1],c=n[2],l=n[3];return t[0]=i*l+s*a+o*c-r*u,t[1]=o*l+s*u+r*a-i*c,t[2]=r*l+s*c+i*u-o*a,t[3]=s*l-i*a-o*u-r*c,t},r.rotateX=function(t,e,n){n*=.5;var i=e[0],o=e[1],r=e[2],s=e[3],a=Math.sin(n),u=Math.cos(n);return t[0]=i*u+s*a,t[1]=o*u+r*a,t[2]=r*u-o*a,t[3]=s*u-i*a,t},r.rotateY=function(t,e,n){n*=.5;var i=e[0],o=e[1],r=e[2],s=e[3],a=Math.sin(n),u=Math.cos(n);return t[0]=i*u-r*a,t[1]=o*u+s*a,t[2]=r*u+i*a,t[3]=s*u-o*a,t},r.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},r.normalize=function(t,e){var n=e[0],i=e[1],o=e[2],r=e[3],s=n*n+i*i+o*o+r*r;return s>0&&(s=1/Math.sqrt(s),t[0]=n*s,t[1]=i*s,t[2]=o*s,t[3]=r*s),t},r.equals=function(t,e){var n=t[0],i=t[1],r=t[2],s=t[3],a=e[0],u=e[1],c=e[2],l=e[3];return Math.abs(n-a)<=o["default"].EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-u)<=o["default"].EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(r-c)<=o["default"].EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(s-l)<=o["default"].EPSILON*Math.max(1,Math.abs(s),Math.abs(l))},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},t.exports=r},function(t,e,n){"use strict";var i=n(2),o=function(t){return t&&t.__esModule?t:{"default":t}}(i),r={};r.create=function(){var t=new o["default"].ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},t.exports=r},function(t,e,n){"use strict";var i=n(2),o=function(t){return t&&t.__esModule?t:{"default":t}}(i),r={};r.create=function(){var t=new o["default"].ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},r.fromValues=function(t,e,n){var i=new o["default"].ARRAY_TYPE(3);return i[0]=t,i[1]=e,i[2]=n,i},r.set=function(t,e,n,i){return t[0]=e,t[1]=n,t[2]=i,t},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},r.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},r.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},r.length=function(t){var e=t[0],n=t[1],i=t[2];return Math.sqrt(e*e+n*n+i*i)},r.normalize=function(t,e){var n=e[0],i=e[1],o=e[2],r=n*n+i*i+o*o;return r>0&&(r=1/Math.sqrt(r),t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r),t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},r.cross=function(t,e,n){var i=e[0],o=e[1],r=e[2],s=n[0],a=n[1],u=n[2];return t[0]=o*u-r*a,t[1]=r*s-i*u,t[2]=i*a-o*s,t},r.transformQuat=function(t,e,n){var i=e[0],o=e[1],r=e[2],s=n[0],a=n[1],u=n[2],c=n[3],l=c*i+a*r-u*o,h=c*o+u*i-s*r,f=c*r+s*o-a*i,p=-s*i-a*o-u*r;return t[0]=l*c+p*-s+h*-u-f*-a,t[1]=h*c+p*-a+f*-s-l*-u,t[2]=f*c+p*-u+l*-a-h*-s,t},t.exports=r},,function(t,e,n){function ComplementaryFilter(t){this.kFilter=t,this.currentAccelMeasurement=new i,this.currentGyroMeasurement=new i,this.previousGyroMeasurement=new i,r.isIOS()?this.filterQ=new o.Quaternion(-1,0,0,1):this.filterQ=new o.Quaternion(1,0,0,1),this.previousFilterQ=new o.Quaternion,this.previousFilterQ.copy(this.filterQ),this.accelQ=new o.Quaternion,this.isOrientationInitialized=!1,this.estimatedGravity=new o.Vector3,this.measuredGravity=new o.Vector3,this.gyroIntegralQ=new o.Quaternion}var i=n(27),o=n(5),r=n(6);ComplementaryFilter.prototype.addAccelMeasurement=function(t,e){this.currentAccelMeasurement.set(t,e)},ComplementaryFilter.prototype.addGyroMeasurement=function(t,e){this.currentGyroMeasurement.set(t,e);var n=e-this.previousGyroMeasurement.timestampS;r.isTimestampDeltaValid(n)&&this.run_(),this.previousGyroMeasurement.copy(this.currentGyroMeasurement)},ComplementaryFilter.prototype.run_=function(){if(!this.isOrientationInitialized)return this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),void(this.isOrientationInitialized=!0);var t=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS,e=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,t);this.gyroIntegralQ.multiply(e),this.filterQ.copy(this.previousFilterQ),this.filterQ.multiply(e);var n=new o.Quaternion;n.copy(this.filterQ),n.inverse(),this.estimatedGravity.set(0,0,-1),this.estimatedGravity.applyQuaternion(n),this.estimatedGravity.normalize(),this.measuredGravity.copy(this.currentAccelMeasurement.sample),this.measuredGravity.normalize();var i=new o.Quaternion;i.setFromUnitVectors(this.estimatedGravity,this.measuredGravity),i.inverse(),r.isDebug()&&console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",o.radToDeg*r.getQuaternionAngle(i),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var s=new o.Quaternion;s.copy(this.filterQ),s.multiply(i),this.filterQ.slerp(s,1-this.kFilter),this.previousFilterQ.copy(this.filterQ)},ComplementaryFilter.prototype.getOrientation=function(){return this.filterQ},ComplementaryFilter.prototype.accelToQuaternion_=function(t){var e=new o.Vector3;e.copy(t),e.normalize();var n=new o.Quaternion;return n.setFromUnitVectors(new o.Vector3(0,0,-1),e),n.inverse(),n},ComplementaryFilter.prototype.gyroToQuaternionDelta_=function(t,e){var n=new o.Quaternion,i=new o.Vector3;return i.copy(t),i.normalize(),n.setFromAxisAngle(i,t.length()*e),n},t.exports=ComplementaryFilter},function(t,e,n){function PosePredictor(t){this.predictionTimeS=t,this.previousQ=new i.Quaternion,this.previousTimestampS=null,this.deltaQ=new i.Quaternion,this.outQ=new i.Quaternion}var i=n(5),o=n(6);PosePredictor.prototype.getPrediction=function(t,e,n){if(!this.previousTimestampS)return this.previousQ.copy(t),this.previousTimestampS=n,t;var r=new i.Vector3;r.copy(e),r.normalize();var s=e.length();if(s<20*i.degToRad)return o.isDebug()&&console.log("Moving slowly, at %s deg/s: no prediction",(i.radToDeg*s).toFixed(1)),this.outQ.copy(t),this.previousQ.copy(t),this.outQ;var a=(this.previousTimestampS,s*this.predictionTimeS);return this.deltaQ.setFromAxisAngle(r,a),this.outQ.copy(this.previousQ),this.outQ.multiply(this.deltaQ),this.previousQ.copy(t),this.previousTimestampS=n,this.outQ},t.exports=PosePredictor},function(t,e){function SensorSample(t,e){this.set(t,e)}SensorSample.prototype.set=function(t,e){this.sample=t,this.timestampS=e},SensorSample.prototype.copy=function(t){this.set(t.sample,t.timestampS)},t.exports=SensorSample}])});
//# sourceMappingURL=view360.yawpitchcontrol.min.js.map